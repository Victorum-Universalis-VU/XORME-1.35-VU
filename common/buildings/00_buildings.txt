#Victorum Universalis Note -
#There is no way to modify this carefully overriding parts of it.
#File has been documented well and organised to the best of our abilities. Any submods or addons desiring to add their own entries will need to manually update this entirely
#after every VU update. This is out of our hands and there are no suggestions for this.
#Furthermore, this file contains new entries throughout various sections and should not crash the game if said entries have been entered and linked correctly with respective files.
#Many thanks to you all - San Felipe.

# Do not change tags in here without changing every other reference to them.
# If adding new buildings, make sure they are uniquely named.

# cost = x #==> cost in $ to build (subject to other modifiers)
# time = x #==> number of months to build.
# modifier = m # a modifier on the province that the building gives
# trigger = t # an and trigger that needs to be fullfilled to build and keep the building
# one_per_country = yes/no # if yes, only one of these can exist in a country
# manufactory = { trade_good trade_good } # list of trade goods that get a production bonus
# onmap = yes/no # show as a sprite on the map

# FROM = FROM
# ROOT = province

# Building AI is now mainly hard-coded. The AI will estimate how much it gains yearly from each building,
# convert the value to ducats, and take the building with biggest yearly return as a percentage of the build cost.
# If lower than 1%, the AI will not consider the yearly return worth it.
# It will also require higher yearly return if the economy in not in prime shape.
# Forts' value also get converted to a yearly return based on terrain and strategic position, as well as available budget for fort maintenance.

# AI can still be modded though; it will multiply the yearly return with the value of ai_will_do.
# If you don't want the AI to build a building at all, make ai_will_do become 0.
# AI will consider each building to be worth 0.01 ducats per year as a base, so making ai_will_do above cost will have them build it at some point.
# It will still check whether it can afford a building before doing so though, but may save up to it.

################################################

### PRODUCTION

#Tier 1 Production - Workshop
workshop = {
	cost = 100
	time = 12
	#Returned price to 100 due to the production efficiency increase.
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	modifier = {
		#Returned modifier to the EU4 50% instead of the VU 30% to make the building more worthwhile, specially in the early game.
		local_production_efficiency = 0.5
	}
	on_built = {
		add_development_from_building = {
			building = workshop
			type = production
			value = 1
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = workshop
			type = production
			value = 1
		}
	}
	on_obsolete = {
	}

	allow_in_gold_provinces = no

	ai_will_do = {
		factor = 10
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 200 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		modifier = {
			factor = 1.5
			base_production = 3
		}
		modifier = {
			factor = 3.5
			base_production = 5
		}
		modifier = {
			factor = 6.5
			base_production = 7
		}
		
		#GENERAL
		#AI is strongly discouraged to build this where climate renders development difficult.
		modifier = {
			factor = 0.2
			OR = {
				has_climate = arctic
				has_climate = arid
				has_climate = tropical
			}
		}
		
		#AI is discouraged to build this where development isn't really feasible.
		modifier = {
			factor = 0.65
			OR = {
				has_terrain = steppe
				has_terrain = highlands
				has_terrain = jungle
				has_terrain = desert
				has_terrain = coastal_desert
				has_terrain = glacier
			}
		}
		
		#Drylands, forest, coastline, marsh, hills, mountains, and savannah receive neither penalty nor bonus.
		
		#AI is encouraged to build this where development is feasible.
		modifier = {
			factor = 1.5
			OR = {
				has_terrain = farmlands
				has_terrain = grasslands
				has_terrain = woods
			}
		}
		
		#Removed for now. Massive gov changes in 1.26 make this not an easy 1 to 1 update
		#modifier = {
		#	factor = 1.5
		#	FROM = {			#Economically minded governments are more likely to build workshops... that is rather their mandate, no?
		#		OR = {
		#			government = administrative_monarchy
		#			government = administrative_republic
		#			government = constitutional_republic
		#			government = peasants_republic
		#		}
		#	}
		#}
		
		#HRE was a production powerhouse of this period.
		modifier = {
			factor = 2.0
			is_part_of_hre = yes
		}
		#Xorme FROM AUTONOMY
		modifier = {
			factor = 0.25
			num_free_building_slots = 2
			NOT = { xorme_has_any_manufactory_trigger = yes }
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		#FROM AUTONOMY
		modifier = {
			factor = 0.25
			num_free_building_slots = 2
			NOT = { xorme_has_any_manufactory_trigger = yes }
		}
		modifier = {
			factor = 0.4
			local_autonomy = 75
		}
		modifier = {
			factor = 0.6
			local_autonomy = 50
		}
		modifier = {
			factor = 0.8
			local_autonomy = 25
		}
		#FROM BASE DEV
		modifier = {
			factor = 3.0
			base_production = 4
		}
		modifier = {
			factor = 6.0
			base_production = 6
		}
		modifier = {
			factor = 9.0
			base_production = 8
		}
		#FROM TRADE GOODS
		modifier = {
			factor = 5.0
			xorme_lowest_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 10.0
			xorme_low_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 15.0
			xorme_medium_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 20.0
			xorme_high_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 25.0
			xorme_province_with_special_goods_produced_trigger = yes
		}
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

#Tier 2 Production - Counting House
counting_house = {
	cost = 400
	time = 24
	#VU price changed from 400 to 200. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces).
	#VU time changed from 12 to 24. Doubling upgraded buildings' build time.
	
	make_obsolete = workshop
	modifier = {
		#Modifier is now 75% instead of the EU4 100% or the VU 60%. It should be balanced for the extra provinces of VU while still being worth its price.
		local_production_efficiency = 0.75
	}

	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}

	modifier = {
		local_production_efficiency = 1
	}

	on_built = {
		add_development_from_upgrading_or_building = {
			building = counting_house
			obsolete_building = workshop
			type = production
			value = 2
			upgrade_value = 1
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = counting_house
			type = production
			value = 2
		}
	}
	on_obsolete = {
	}

	allow_in_gold_provinces = no

	ai_will_do = {
		factor = 15
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		modifier = {
			factor = 1.5
			base_production = 3
		}
		modifier = {
			factor = 3.5
			base_production = 5
		}
		modifier = {
			factor = 6.5
			base_production = 7
		}
		
		#GENERAL		
		#AI is strongly discouraged to build this where climate renders development difficult.
		modifier = {
			factor = 0.2
			OR = {
				has_climate = arctic
				has_climate = arid
				has_climate = tropical
			}
		}
		
		#AI is discouraged to build this where development isn't really feasible.
		modifier = {
			factor = 0.65
			OR = {
				has_terrain = steppe
				has_terrain = highlands
				has_terrain = jungle
				has_terrain = desert
				has_terrain = coastal_desert
				has_terrain = glacier
			}
		}
		
		#Drylands, forest, coastline, marsh, hills, mountains, and savannah receive neither penalty nor bonus.
		
		#AI is encouraged to build this where development is feasible.
		modifier = {
			factor = 1.5
			OR = {
				has_terrain = farmlands
				has_terrain = grasslands
				has_terrain = woods
			}
		}
		
		#Removed for now. Massive gov changes in 1.26 make this not an easy 1 to 1 update
		#modifier = {
		#	factor = 1.5
		#	FROM = {			#Economically minded governments are more likely to build workshops... that is rather their mandate, no?
		#		OR = {
		#			government = administrative_monarchy
		#			government = administrative_republic
		#			government = constitutional_republic
		#			government = peasants_republic
		#		}
		#	}
		#}
		
		#HRE was a production powerhouse of this period.
		modifier = {
			factor = 2.0
			is_part_of_hre = yes
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		#FROM AUTONOMY
		modifier = {
			factor = 0.25
			num_free_building_slots = 2
		}
		modifier = {
			factor = 0.4
			local_autonomy = 75
		}
		modifier = {
			factor = 0.6
			local_autonomy = 50
		}
		modifier = {
			factor = 0.8
			local_autonomy = 25
		}
		#FROM UPGRADE
		modifier = {
			factor = 25.0
			has_building = workshop
		}
		#FROM BASE DEV
		modifier = {
			factor = 3.0
			base_production = 4
		}
		modifier = {
			factor = 6.0
			base_production = 6
		}
		modifier = {
			factor = 9.0
			base_production = 8
		}
		#Xorme FROM TRADE GOODS
		modifier = {
			factor = 5.0
			xorme_lowest_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 10.0
			xorme_low_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 15.0
			xorme_medium_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 20.0
			xorme_high_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 25.0
			xorme_province_with_special_goods_produced_trigger = yes
		}
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

#Tier 3 Production - Treasury
treasury = {
	cost = 400
	time = 36
	#Same price as the EU4 Counting House.
	
	make_obsolete = counting_house
	modifier = {
		local_production_efficiency = 1.0
		#Same modifier as the EU4 Counting House.
	}

	allow_in_gold_provinces = no

	ai_will_do = {
		factor = 6
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 800 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		modifier = {
			factor = 1.5
			base_production = 3
		}
		modifier = {
			factor = 3.5
			base_production = 5
		}
		modifier = {
			factor = 6.5
			base_production = 7
		}
		
		#GENERAL		
		#AI is strongly discouraged to build this where climate renders development difficult.
		modifier = {
			factor = 0.2
			OR = {
				has_climate = arctic
				has_climate = arid
				has_climate = tropical
			}
		}
		
		#AI is discouraged to build this where development isn't really feasible.
		modifier = {
			factor = 0.65
			OR = {
				has_terrain = steppe
				has_terrain = highlands
				has_terrain = jungle
				has_terrain = desert
				has_terrain = coastal_desert
				has_terrain = glacier
			}
		}
		
		#Drylands, forest, coastline, marsh, hills, mountains, and savannah receive neither penalty nor bonus.
		
		#AI is encouraged to build this where development is feasible.
		modifier = {
			factor = 1.5
			OR = {
				has_terrain = farmlands
				has_terrain = grasslands
				has_terrain = woods
			}
		}
		
		#Removed for now. Massive gov changes in 1.26 make this not an easy 1 to 1 update
		#modifier = {
		#	factor = 1.5
		#	FROM = {			#Economically minded governments are more likely to build workshops... that is rather their mandate, no?
		#		OR = {
		#			government = administrative_monarchy
		#			government = administrative_republic
		#			government = constitutional_republic
		#			government = peasants_republic
		#		}
		#	}
		#}
		
		#HRE was a production powerhouse of this period.
		modifier = {
			factor = 2.0
			is_part_of_hre = yes
		}
	}
}

#Tier 4 Production - Factory 
factory = {
	cost = 800
	time = 48
	#Factories are expensive and take a long time to build because they're the last tier of the production category and are quite powerful (as they should be).
	
	make_obsolete = treasury
	modifier = {
		local_production_efficiency = 2.0
		#Factories had a massive impact on production (Industrial Revolution) so they're represented by having a huge modifier.
	}

	allow_in_gold_provinces = no

	ai_will_do = {
		factor = 9
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 1600 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		modifier = {
			factor = 1.5
			base_production = 3
		}
		modifier = {
			factor = 3.5
			base_production = 5
		}
		modifier = {
			factor = 6.5
			base_production = 7
		}
		
		#GENERAL		
		#AI is strongly discouraged to build this where climate renders development difficult.
		modifier = {
			factor = 0.2
			OR = {
				has_climate = arctic
				has_climate = arid
				has_climate = tropical
			}
		}
		
		#AI is discouraged to build this where development isn't really feasible.
		modifier = {
			factor = 0.65
			OR = {
				has_terrain = steppe
				has_terrain = highlands
				has_terrain = jungle
				has_terrain = desert
				has_terrain = coastal_desert
				has_terrain = glacier
			}
		}
		
		#Drylands, forest, coastline, marsh, hills, mountains, and savannah receive neither penalty nor bonus.
		
		#AI is encouraged to build this where development is feasible.
		modifier = {
			factor = 1.5
			OR = {
				has_terrain = farmlands
				has_terrain = grasslands
				has_terrain = woods
			}
		}
		
		#Removed for now. Massive gov changes in 1.26 make this not an easy 1 to 1 update
		#modifier = {
		#	factor = 1.5
		#	FROM = {			#Economically minded governments are more likely to build workshops... that is rather their mandate, no?
		#		OR = {
		#			government = administrative_monarchy
		#			government = administrative_republic
		#			government = constitutional_republic
		#			government = peasants_republic
		#		}
		#	}
		#}
		
		#Removed HRE factor since historically it was abolished in the start of the 19th century.
		#It could be replaced by a United Kingdom (2.0), Netherlands (1.75), Germany (1.75) and France (1.5) bonus since they became industrial powerhouses at the time.
		#modifier = {
		#	factor = 2.0
		#	is_part_of_hre = yes
		#}
	}
}

################################################

### TRADE

#Tier 1 Trade - Marketplace
marketplace = {
	cost = 100
	time = 12

	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}

	modifier = {
		province_trade_power_modifier = 0.25
		#VU changed from 0.5. A 50% bonus available at practically day 1 was overpowered, and it snowballed for Centers of Trade.
		#While we still want CoTs strong, we don't want them x15 stronger than any other province this early
		#VU's lower avg dev but generally same dev for capitals and CoTs only made this worse, as well.
	}
	
	on_built = {
		add_development_from_building = {
			building = marketplace
			type = production
			value = 1
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = marketplace
			type = production
			value = 1
		}
	}

	on_construction_started = { } #Fires when you start the construction,  ROOT - Province FROM - Country that started
	on_construction_canceled = { } #Fires when you cancel the construction, ROOT - Province FROM - Country that canceled

	on_obsolete = {
	}

	ai_will_do = {
		factor = 1.5 # Because hard-coded AI only considers what it will gain, not what its enemies will lose.
		
		#ECONOMY 101
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 200 } }
		}
		
		#SPECIFIC
		#AI less likely to build if there isn't a center of trade
		modifier = {
			factor = 0.5
			NOT = { province_has_center_of_trade_of_level = 1 }
		}
		
		#AI more likely to build if there is a center of trade
		modifier = {
			factor = 10.0
			province_has_center_of_trade_of_level = 1
		}
		modifier = {
			factor = 20.0
			province_has_center_of_trade_of_level = 2
		}
		modifier = {
			factor = 30.0
			province_has_center_of_trade_of_level = 1
		}
		
		#AI more likely to build if there is a river estuary
		modifier = {
			factor = 5.0
			has_river_estuary_trigger = yes
		}
		
		#GENERAL
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note 25 is base for several mercantile nations like England, so some will start with this, and many more reach it later.
		modifier = {
			factor = 0.65
			NOT = { FROM = { mercantilism = 25 } }
		}
		
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note England can hit 40s by the late 1400s with some luck, so this isn't so high.
		modifier = {
			factor = 1.5
			FROM = { mercantilism = 40 }
		}
		
		#Trade leagues and merchant republics will get more trade buildings... that is rather their mandate, no?
		modifier = {
			factor = 2.0
			FROM = {
				OR = {
					is_in_trade_league = yes
					has_government_attribute = is_merchant_republic
					has_reform = trading_city
					has_reform = veche_republic
				}
			}
		}
		
		#Just to encourage a bit of English Channel node competition. Dutch society flourished on trade in this period.
		modifier = {
			factor = 2.0
			FROM = { primary_culture = dutch }			
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 10
			province_has_center_of_trade_of_level = 1
		}
		modifier = {
			factor = 20
			province_has_center_of_trade_of_level = 2
		}
		modifier = {
			factor = 30
			province_has_center_of_trade_of_level = 3
		}
		#Xorme
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
	}
}

#Tier 2 Trade - Trade Depot
trade_depot = {
	cost = 300
	time = 24
	#VU price changed from 300.
	#VU time changed from 12. Doubling upgraded buildings' build time.
	
	make_obsolete = marketplace
	modifier = {
		province_trade_power_modifier = 0.5
		#VU changed from 1.0, for reasons explained in market entry.
	}
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}

	modifier = {
		province_trade_power_modifier = 1
	}

	on_built = {
		add_development_from_upgrading_or_building = {
			building = trade_depot
			obsolete_building = marketplace
			type = production
			value = 2
			upgrade_value = 1
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = trade_depot
			type = production
			value = 2
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 2.5 # Because hard-coded AI only considers what it will gain, not what its enemies will lose.
		
		#ECONOMY 101
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		
		#SPECIFIC
		#AI less likely to build if there isn't a center of trade
		modifier = {
			factor = 0.5
			NOT = { province_has_center_of_trade_of_level = 1 }
		}
		
		#AI more likely to build if there is a center of trade
		modifier = {
			factor = 10.0
			province_has_center_of_trade_of_level = 1
		}
		modifier = {
			factor = 20.0
			province_has_center_of_trade_of_level = 2
		}
		modifier = {
			factor = 30.0
			province_has_center_of_trade_of_level = 1
		}
		
		#AI more likely to build if there is a river estuary
		modifier = {
			factor = 5.0
			has_river_estuary_trigger = yes
		}
		
		#GENERAL		
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note 25 is base for several mercantile nations like England, so some will start with this, and many more reach it later.
		modifier = {
			factor = 0.65
			NOT = { FROM = { mercantilism = 25 } }
		}
		
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note England can hit 40s by the late 1400s with some luck, so this isn't so high.
		modifier = {
			factor = 1.5
			FROM = { mercantilism = 40 }
		}
		
		#Trade leagues and merchant republics will get more trade buildings... that is rather their mandate, no?
		modifier = {
			factor = 2.0
			FROM = {
				OR = {
					is_in_trade_league = yes
					has_government_attribute = is_merchant_republic
					has_reform = trading_city
					has_reform = veche_republic
				}
			}
		}
		
		#Just to encourage a bit of English Channel node competition. Dutch society flourished on trade in this period.
		modifier = {
			factor = 2.0
			FROM = { primary_culture = dutch }
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		#FROM UPGRADE
		modifier = {
			factor = 25.0
			has_building = marketplace
		}
		modifier = {
			factor = 10
			province_has_center_of_trade_of_level = 1
		}
		modifier = {
			factor = 20
			province_has_center_of_trade_of_level = 2
		}
		modifier = {
			factor = 30
			province_has_center_of_trade_of_level = 3
		}
		#Xorme
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
	}
}

#Tier 3 Trade - Stock Exchange
stock_exchange = {
	cost = 400
	time = 36
	#VU time changed from 12. Tripling stock exchange build time, as a doubled upgraded building.
	
	make_obsolete = trade_depot
	modifier = {
		province_trade_power_modifier = 1.0
	}
	
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}

	modifier = {
		province_trade_power_modifier = 1.25
	}

	on_built = {
		if = {
			limit = {
				has_province_flag = built_dev_trade_depot
			}
			add_development_from_upgrading_or_building = {
				building = stock_exchange
				obsolete_building = trade_depot
				type = production
				value = 3
				upgrade_value = 1
			}
		}
		else_if = {
			limit = {
				has_province_flag = built_dev_marketplace
			}
			add_development_from_upgrading_or_building = {
				building = stock_exchange
				obsolete_building = marketplace
				type = production
				value = 3
				upgrade_value = 2
			}
		}
		else = {
			add_development_from_building = {
				building = stock_exchange
				type = production
				value = 3
			}
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = stock_exchange
			type = production
			value = 3
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 3.5 # Because hard-coded AI only considers what it will gain, not what its enemies will lose.
		
		#ECONOMY 101
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 800 } }
		}
		
		#SPECIFIC
		#AI less likely to build if there isn't a center of trade
		modifier = {
			factor = 0.5
			NOT = { province_has_center_of_trade_of_level = 1 }
		}
		
		#AI more likely to build if there is a center of trade
		modifier = {
			factor = 10.0
			province_has_center_of_trade_of_level = 1
		}
		modifier = {
			factor = 20.0
			province_has_center_of_trade_of_level = 2
		}
		modifier = {
			factor = 30.0
			province_has_center_of_trade_of_level = 1
		}
		
		#AI more likely to build if there is a river estuary
		modifier = {
			factor = 5.0
			has_river_estuary_trigger = yes
		}
		
		#GENERAL	
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note 25 is base for several mercantile nations like England, so some will start with this, and many more reach it later.
		modifier = {
			factor = 0.65
			NOT = { FROM = { mercantilism = 25 } }
		}
		
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note England can hit 40s by the late 1400s with some luck, so this isn't so high.
		modifier = {
			factor = 1.5
			FROM = { mercantilism = 40 }
		}
		
		#Trade leagues and merchant republics will get more trade buildings... that is rather their mandate, no?
		modifier = {
			factor = 2.0
			FROM = {
				OR = {
					is_in_trade_league = yes
					has_government_attribute = is_merchant_republic
					has_reform = trading_city
					has_reform = veche_republic
				}
			}
		}
		
		#Just to encourage a bit of English Channel node competition. Dutch society flourished on trade in this period.
		modifier = {
			factor = 2.0
			FROM = { primary_culture = dutch }
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		#FROM UPGRADE
		modifier = {
			factor = 25.0
			OR = {
				has_building = marketplace
				has_building = trade_depot
			}
		}
		modifier = {
			factor = 10
			province_has_center_of_trade_of_level = 1
		}
		modifier = {
			factor = 20
			province_has_center_of_trade_of_level = 2
		}
		modifier = {
			factor = 30
			province_has_center_of_trade_of_level = 3
		}
		#Xorme
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
	}
}

#Tier 4 Trade - Corporative Headquarters
corporative_headquarters = {
	cost = 800
	time = 48
	
	make_obsolete = stock_exchange
	modifier = {
		province_trade_power_modifier = 2.0
		#VU changed from 1.25. While earlier levels were weaker than vanilla, I'm increasing the final level, because by this tech level, the centres of wealth should be pulling a massive slice of the wealth in a node, and the many new provinces will have had plenty chance to build up and compete with the capitals much more than in vanilla.
	}

	ai_will_do = {
		factor = 9
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 1600 } }
		}
		
		#SPECIFIC
		#AI less likely to build if there isn't a center of trade
		modifier = {
			factor = 0.5
			NOT = { province_has_center_of_trade_of_level = 1 }
		}
		
		#AI more likely to build if there is a center of trade
		modifier = {
			factor = 10.0
			province_has_center_of_trade_of_level = 1
		}
		modifier = {
			factor = 20.0
			province_has_center_of_trade_of_level = 2
		}
		modifier = {
			factor = 30.0
			province_has_center_of_trade_of_level = 1
		}
		
		#AI more likely to build if there is a river estuary
		modifier = {
			factor = 5.0
			has_river_estuary_trigger = yes
		}
		
		#GENERAL		
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note 25 is base for several mercantile nations like England, so some will start with this, and many more reach it later.
		modifier = {
			factor = 0.65
			NOT = { FROM = { mercantilism = 25 } }
		}
		
		#I know this is probably already factored in, but I want highly mercantile states to build trade buildings everywhere, while lower mercantilism states only build these in provinces with high TP.
		#Note England can hit 40s by the late 1400s with some luck, so this isn't so high.
		modifier = {
			factor = 1.5
			FROM = { mercantilism = 40 }
		}
		
		#Trade leagues and merchant republics will get more trade buildings... that is rather their mandate, no?
		modifier = {
			factor = 2.0
			FROM = {
				OR = {
					is_in_trade_league = yes
					has_government_attribute = is_merchant_republic
					has_reform = trading_city
					has_reform = veche_republic
				}
			}
		}
		
		#Just to encourage a bit of English Channel node competition. Dutch society flourished on trade in this period.
		modifier = {
			factor = 2.0
			FROM = { primary_culture = dutch }
		}
	}
}

################################################

### ARMY

#Tier 1 Army - Barracks
barracks = {
	cost = 100
	time = 12

	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	modifier = {
		local_manpower_modifier = 0.5
	}
	on_built = {
		if = {
			limit = {
				FROM = {
					has_government_attribute = manpower_sailors_on_build
				}
			}
			FROM = {
				add_manpower = 1
			}
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = 0.001
			}
		}
		add_development_from_building = {
			building = barracks
			type = manpower
			value = 1
		}
		update_improved_military_buildings_modifier = {
			building = barracks
		}
	}
	on_destroyed = {
		if = {
			limit = {
				FROM = {
					has_government_attribute = manpower_sailors_on_build
				}
			}
			FROM = {
				add_manpower = -1
			}
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = -0.001
			}
		}
		remove_development_from_building = {
			building = barracks
			type = manpower
			value = 1
		}
		update_improved_military_buildings_modifier = {
			building = barracks
		}
	}
	on_obsolete = {
	}

#	# THIS = Province, FROM = Builder(not nessecairly owner, can be overlord)
#	on_built = {
#		FROM = {
#			add_army_professionalism = 0.005
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings made obsolete!
#	on_destroyed = {
#		FROM = {
#			add_army_professionalism = -0.01
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings destroyed!
#	on_obsolete = {
#		hidden_effect = {
#			FROM = {
#				add_army_professionalism = -0.005
#			}
#		}
#	}
	
	modifier = {
		local_manpower_modifier = 0.25
		#VU changed from 0.5. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces).
	}


	ai_will_do = {
		factor = 4.5
        
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 200 } }
        }
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 1.5
			base_manpower = 3
		}
		modifier = {
			factor = 3.5
			base_manpower = 5
		}
		modifier = {
			factor = 6.5
			base_manpower = 7
		}
		
		#GENERAL
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 0.5
			NOT = { FROM = { army_tradition = 20 } }
		}
		
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 0.8
			NOT = { FROM = { army_tradition = 40 } }
		}
		
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 1.2
			FROM = { army_tradition = 60 }
		}
		
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 1.5
			FROM = { army_tradition = 80 }
		}
		
		#Further encouraged if low on manpower
		modifier = {
			factor = 1.2
			NOT = { owner = { manpower_percentage = 0.35 } }
		}
		
		#Slightly discouraged if plenty of manpower
		modifier = {
			factor = 0.9
			owner = { manpower_percentage = 0.8 }
		}
		
		#Removed for now. Massive gov changes in 1.26 make this not an easy 1 to 1 update
		#modifier = {
		#	factor = 1.5
		#	FROM = {			#Military minded governments are more likely to build barracks... that is rather their mandate, no?
		#		OR = {
		#			government = feudal_monarchy
		#			government = enlightened_despotism
		#			government = revolutionary_empire
		#			government = steppe_horde
		#		}
		#	}
		#}
		
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 0.65
			local_autonomy = 40
		}
		
		modifier = {
			factor = 0.65
			is_state = no
		}
		#Xorme FROM AUTONOMY
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		#FROM AUTONOMY
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0.4
			local_autonomy = 75
		}
		modifier = {
			factor = 0.6
			local_autonomy = 50
		}
		modifier = {
			factor = 0.8
			local_autonomy = 25
		}
		#FROM BASE DEV
		modifier = {
			factor = 3.0
			base_manpower = 4
		}
		modifier = {
			factor = 6.0
			base_manpower = 6
		}
		modifier = {
			factor = 9.0
			base_manpower = 8
		}
		#FROM TRADE GOODS
		modifier = {
			factor = 10.0
			xorme_additional_manpower_goods_trigger = yes
		}
		#BUILDINGS
		modifier = {
			factor = 10.0
			xorme_has_production_buildings_trigger = yes
		}
		modifier = {
			factor = 100.0
			num_free_building_slots = 3
		}
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

#Tier 2 Army - Training Fields
training_fields = {
	cost = 300
	time = 12
	#VU price changed from 300. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces).
	#VU time changed from 12. Doubling second level military buildings build time.

	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}

	modifier = {
		local_manpower_modifier = 1
	}

	on_built = {
		if = {
			limit = {
				FROM = {
					has_government_attribute = manpower_sailors_on_build
				}
			}
			FROM = {
				add_manpower = 1
			}
		}
		add_development_from_upgrading_or_building = {
			building = training_fields
			obsolete_building = barracks
			type = manpower
			value = 2
			upgrade_value = 1
		}
		update_improved_military_buildings_modifier = {
			building = training_fields
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = 0.001
			}
		}
	}
	on_destroyed = {
		if = {
			limit = {
				FROM = {
					has_government_attribute = manpower_sailors_on_build
				}
			}
			FROM = {
				add_manpower = -1
			}
		}
		update_improved_military_buildings_modifier = {
			building = training_fields
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = -0.001
			}
		}
		remove_development_from_building = {
			building = training_fields
			type = manpower
			value = 2
		}
	}
	on_obsolete = {
	}

#	# THIS = Province, FROM = Builder(not nessecairly owner, can be overlord)
#	on_built = {
#		FROM = {
#			add_army_professionalism = 0.01
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings made obsolete!
#	on_destroyed = {
#		FROM = {
#			add_army_professionalism = -0.02
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings destroyed!
#	on_obsolete = {
#		hidden_effect = {
#			FROM = {
#				add_army_professionalism = -0.01
#			}
#		}
#	}
	
	make_obsolete = barracks
	modifier = {
		local_manpower_modifier = 0.5
		#VU changed from 1.0. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces).
	}

	ai_will_do = {
		factor = 3.5
		
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 400 } }
        }
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 1.5
			base_manpower = 3
		}
		modifier = {
			factor = 3.5
			base_manpower = 5
		}
		modifier = {
			factor = 6.5
			base_manpower = 7
		}
		
		#GENERAL		
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 0.5
			NOT = { FROM = { army_tradition = 20 } }
		}
		
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 0.8
			NOT = { FROM = { army_tradition = 40 } }
		}
		
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 1.2
			FROM = { army_tradition = 60 }
		}
		
		#Army tradition now either encourages or discourages building barracks
		modifier = {
			factor = 1.5
			FROM = { army_tradition = 80 }			
		}
		
		#Further encouraged if low on manpower
		modifier = {
			factor = 1.2
			NOT = { owner = { manpower_percentage = 0.35 } }
		}
		
		#Slightly discouraged if plenty of manpower
		modifier = {
			factor = 0.9
			owner = { manpower_percentage = 0.8 }
		}
		
		#Removed for now. Massive gov changes in 1.26 make this not an easy 1 to 1 update
		#modifier = {
		#	factor = 1.5
		#	FROM = {			#Military minded governments are more likely to build barracks... that is rather their mandate, no?
		#		OR = {
		#			government = feudal_monarchy
		#			government = enlightened_despotism
		#			government = revolutionary_empire
		#			government = steppe_horde
		#		}
		#	}
		#}
		
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 0.65
			local_autonomy = 40
		}
		
		modifier = {
			factor = 0.65
			is_state = no
		}
		#Xorme FROM AUTONOMY
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		#FROM AUTONOMY
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0.4
			local_autonomy = 75
		}
		modifier = {
			factor = 0.6
			local_autonomy = 50
		}
		modifier = {
			factor = 0.8
			local_autonomy = 25
		}
		#FROM UPGRADE
		modifier = {
			factor = 25.0
			has_building = barracks
		}
		#FROM BASE DEV
		modifier = {
			factor = 3.0
			base_manpower = 4
		}
		modifier = {
			factor = 6.0
			base_manpower = 6
		}
		modifier = {
			factor = 9.0
			base_manpower = 8
		}
		#FROM TRADE GOODS
		modifier = {
			factor = 10.0
			xorme_additional_manpower_goods_trigger = yes
		}
		#BUILDINGS
		modifier = {
			factor = 10.0
			xorme_has_production_buildings_trigger = yes
		}
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

#Tier 1 Army - Regimental Camp
regimental_camp = {
	cost = 200
	time = 12
	
	#VU changed from 200. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces)
	
#	# THIS = Province, FROM = Builder(not nessecairly owner, can be overlord)
#	on_built = {
#		FROM = {
#			add_army_professionalism = 0.005
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings made obsolete!
#	on_destroyed = {
#		FROM = {
#			add_army_professionalism = -0.01
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings destroyed!
#	on_obsolete = {
#		hidden_effect = {
#			FROM = {
#				add_army_professionalism = -0.005
#			}
#		}
#	}
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}

	modifier = {
		land_forcelimit = 0.5
		#VU changed from 1.0. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces).
		
		regiment_recruit_speed = -0.125
		#VU new. Adding this new feature to match the shipyard equivalents, which also speed recruit time.
	}

	on_built = {
		add_development_from_building = {
			building = regimental_camp
			type = manpower
			value = 1
		}
		update_improved_military_buildings_modifier = {
			building = regimental_camp
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = 0.001
			}
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = regimental_camp
			type = manpower
			value = 1
		}
		update_improved_military_buildings_modifier = {
			building = regimental_camp
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = -0.001
			}
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 5.5
		
		#Better AI Economy
        
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
		#AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 200 } }
        }
		
		#GENERAL
		#Running total 72
		modifier = {
			factor = 1.2
			FROM = { army_size_percentage = 0.75 }
		}
		
		#Running total 93.6
		modifier = {
			factor = 1.3
			FROM = { army_size_percentage = 1.0 }
		}
		
		#Running total 131.04
		modifier = {
			factor = 1.4
			FROM = { army_size_percentage = 1.25 }
		}
		
		#Running total 196.56
		modifier = {
			factor = 1.5			
			FROM = { army_size_percentage = 1.5 }
		}
		
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 0.75
			NOT = { FROM = { army_tradition = 20 } }
		}
		
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 0.9
			NOT = { FROM = { army_tradition = 40 } }
		}
		
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 1.1
			FROM = { army_tradition = 60 }			
		}
		
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 1.25
			FROM = { army_tradition = 80 }			
		}
		
		#Heavy handed attempt to encourage historical miltary powers
		modifier = {
			factor = 1.5
			FROM = {
				OR = {
					culture_group = french			#The great blue blob
					primary_culture = prussian			#Punched massively above its weight during this period
					primary_culture = saxon			#Punched massively above its weight during this period
					primary_culture = pommeranian			#Punched massively above its weight during this period
					primary_culture = austrian			#Somehow resisted the Ottomans and largely kept the empire together
					primary_culture = swedish			#Punched above its weight during this period
					primary_culture = turkish			#The great green blob
					#Other cultures around the world might deserve this as well, but this is -Europa- Universalis, so I'm only focusing on Europe and environs for now
				}
			}
		}
		
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 0.65
			local_autonomy = 40
		}
		
		modifier = {
			factor = 0.65
			is_state = no
		}
		#Xorme
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		#FROM AUTONOMY
		modifier = {
			factor = 0
			FROM = {
				NOT = { army_size_percentage = 0.9 }
			}
		}
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0.4
			local_autonomy = 75
		}
		modifier = {
			factor = 0.6
			local_autonomy = 50
		}
		modifier = {
			factor = 0.8
			local_autonomy = 25
		}
		#FROM BASE DEV
		modifier = {
			factor = 3.0
			FROM = { num_of_cities = 5 }
		}
		modifier = {
			factor = 6.0
			FROM = { num_of_cities = 10 }
		}
		modifier = {
			factor = 9.0
			FROM = { num_of_cities = 15 }
		}
		modifier = {
			factor = 20.0
			NOT = { development = 7 }
		}
		#BUILDINGS
		modifier = {
			factor = 100.0
			xorme_has_production_buildings_trigger = yes
		}
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
		modifier = {
			factor = 100.0
			num_free_building_slots = 2
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

#Tier 2 Army - Conscription Center
conscription_center = {
	cost = 400
	time = 12
	#VU price changed from 400. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces).
	#VU time changed from 12. Doubling second level military buildings build time.
	
#	# THIS = Province, FROM = Builder(not nessecairly owner, can be overlord)
#	on_built = {
#		FROM = {
#			add_army_professionalism = 0.01
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings made obsolete!
#	on_destroyed = {
#		FROM = {
#			add_army_professionalism = -0.02
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings destroyed!
#	on_obsolete = {
#		hidden_effect = {
#			FROM = {
#				add_army_professionalism = -0.01
#			}
#		}
#	}
	
	make_obsolete = regimental_camp
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}

	modifier = {
		land_forcelimit = 2
		#VU changed from 2.0. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces).
		regiment_recruit_speed = -0.25
		#VU new. Adding this new feature to match the shipyard equivalents, which also speed recruit time.
	}
	on_built = {
		add_development_from_upgrading_or_building = {
			building = conscription_center
			obsolete_building = regimental_camp
			type = manpower
			value = 2
			upgrade_value = 1
		}
		update_improved_military_buildings_modifier = {
			building = conscription_center
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = 0.001
			}
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = conscription_center
			type = manpower
			value = 2
		}
		update_improved_military_buildings_modifier = {
			building = conscription_center
		}
		if = {
			limit = {
				FROM = {
					mission_completed = jap_tanegashima_teppo
					has_dlc = "Cradle of Civilization" 
				}
			}
			FROM = {
				add_army_professionalism = -0.001
			}
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 6.5
		
		#Better AI Economy
        
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
		#AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 400 } }
        }
		
		#GENERAL		
		#Running total 216
		modifier = {
			factor = 1.2			
			FROM = { army_size_percentage = 0.75 }
		}
		
		#Running total 280.8
		modifier = {
			factor = 1.3			
			FROM = { army_size_percentage = 1.0 }
		}
		
		#Running total 393.12
		modifier = {
			factor = 1.4			
			FROM = { army_size_percentage = 1.25 }
		}
		
		#Running total 589.68
		modifier = {
			factor = 1.5			
			FROM = { army_size_percentage = 1.5 }
		}
		
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 0.75
			NOT = { FROM = { army_tradition = 20 } }			
		}
		
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 0.9
			NOT = { FROM = { army_tradition = 40 } }			
		}
		
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 1.1
			FROM = { army_tradition = 60 }			
		}
		
		#Army tradition now either encourages or discourages building camps
		modifier = {
			factor = 1.25
			FROM = { army_tradition = 80 }			
		}
		
		#Heavy handed attempt to encourage historical miltary powers
		modifier = {
			factor = 1.5
			FROM = {
				OR = {			
					culture_group = french			#The great blue blob
					primary_culture = prussian			#Punched massively above its weight during this period
					primary_culture = saxon			#Punched massively above its weight during this period
					primary_culture = pommeranian			#Punched massively above its weight during this period
					primary_culture = austrian			#Somehow resisted the Ottomans and largely kept the empire together
					primary_culture = swedish			#Punched above its weight during this period
					primary_culture = turkish			#The great green blob
					#Other cultures around the world might deserve this as well, but this is -Europa- Universalis, so I'm only focusing on Europe and environs for now
				}
			}
		}
		
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 0.65
			local_autonomy = 40
		}
		
		modifier = {
			factor = 0.65
			is_state = no
		}
		#Xorme
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		#FROM AUTONOMY
		modifier = {
			factor = 0
			FROM = {
				NOT = { army_size_percentage = 0.9 }
			}
		}
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0.4
			local_autonomy = 75
		}
		modifier = {
			factor = 0.6
			local_autonomy = 50
		}
		modifier = {
			factor = 0.8
			local_autonomy = 25
		}
		#FROM UPGRADE
		modifier = {
			factor = 25.0
			has_building = regimental_camp
		}
		#FROM BASE DEV
		modifier = {
			factor = 3.0
			FROM = { num_of_cities = 5 }
		}
		modifier = {
			factor = 6.0
			FROM = { num_of_cities = 10 }
		}
		modifier = {
			factor = 9.0
			FROM = { num_of_cities = 15 }
		}
		modifier = {
			factor = 20.0
			NOT = { development = 7 }
		}
		#BUILDINGS
		modifier = {
			factor = 100.0
			xorme_has_production_buildings_trigger = yes
		}
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

################################################

### Navy

#Tier 1 Navy - Shipyard
shipyard = {
	cost = 100
	time = 12
	#VU notes - leaving cost here despite lowering most others. Dramtically improving naval capabilities was a bit overpowered, in my opinion.
	#Especially compared to the regimental camp with half effect at double the price.
	
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
		has_port = yes
	}

	modifier = {
		ship_recruit_speed = -0.25
		local_ship_repair = 0.25
		#Moved naval_forcelimit to dock and drydock since faster build and repair speed already makes this building worthwhile.
	}
	
	modifier = {
		naval_forcelimit = 2
		ship_recruit_speed = -0.25
		local_ship_repair = 0.25
		local_has_man_of_war = yes
		local_has_galleass = yes
	}
	on_built = {
		add_development_from_building = {
			building = shipyard
			type = production
			value = 1
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = shipyard
			type = production
			value = 1
		}
		if = {
			limit = { has_province_modifier = sca_swe_danish_shipyard }
			remove_province_modifier = sca_swe_danish_shipyard
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 4.5
        
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 200 } }
        }
		
		#SPECIFIC
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 400 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1000 }
		}
		
		#GENERAL
		#VU AddOn removed navy size modifier below, replaced with a more detailed version in new factors
		#modifier = {
		#	factor = 105 # Little above build cost
		#	FROM = { navy_size_percentage = 0.95 }
		#}
		#VU AddOn removed autonomy modifier below
		#modifier = {
		#	factor = 1.1
		#	local_autonomy = 50
		#}
		
		#VU Addon New factors, range 40 percent to 676 percent (replacing vanilla 100 percent to 11,550). I'm assuming from vanilla's high factor that the AI doesn't consider forcelimits as valuable, but if you start seeing too many or too few, please do report.
		
		#Running total 72
		modifier = {
			factor = 1.2			
			FROM = { navy_size_percentage = 0.75 }
		}
		
		#Running total 93.6
		modifier = {
			factor = 1.3			
			FROM = { navy_size_percentage = 1.0 }
		}
		
		#Running total 131.04
		modifier = {
			factor = 1.4			
			FROM = { navy_size_percentage = 1.25 }
		}
		
		#Running total 196.56
		modifier = {
			factor = 1.5			
			FROM = { navy_size_percentage = 1.5 }
		}
		
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 0.75
			NOT = { FROM = { navy_tradition = 20 } }			
		}
		
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 0.9
			NOT = { FROM = { navy_tradition = 40 } }			
		}
		
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 1.1
			FROM = { navy_tradition = 60 }			
		}
		
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 1.25
			FROM = { navy_tradition = 80 }			
		}
		
		#Heavy handed attempt to encourage historical naval powers
		modifier = {
			factor = 1.5
			FROM = {
				OR = {			
					culture_group = british			#The second empire on which the sun never sets
					culture_group = iberian			#The first empire on which the sun never sets
					primary_culture = dutch			#Punched massively above its weight on the sea during this period
					primary_culture = venetian			#Remnants of Mediterranean hegemonies and great naval traditions
					primary_culture = ligurian			#Remnants of Mediterranean hegemonies and great naval traditions
				}
			}
		}
		
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 0.65
			local_autonomy = 40
		}
		
		modifier = {
			factor = 0.65
			is_state = no
		}
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		#FROM AUTONOMY
		modifier = {
			factor = 0
			FROM = {
				NOT = { navy_size_percentage = 0.9 }
			}
		}
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0.4
			local_autonomy = 75
		}
		modifier = {
			factor = 0.6
			local_autonomy = 50
		}
		modifier = {
			factor = 0.8
			local_autonomy = 25
		}
		#FROM BASE DEV
		modifier = {
			factor = 3.0
			FROM = { num_of_ports = 5 }
		}
		modifier = {
			factor = 6.0
			FROM = { num_of_ports = 10 }
		}
		modifier = {
			factor = 9.0
			FROM = { num_of_ports = 15 }
		}
		modifier = {
			factor = 10.0
			NOT = { development = 7 }
		}
		#BUILDINGS
		modifier = {
			factor = 10.0
			xorme_has_production_buildings_trigger = yes
		}
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
		modifier = {
			factor = 100.0
			num_free_building_slots = 4
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

#Tier 2 Navy - Training Fields
grand_shipyard = {
	cost = 300
	time = 12

	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
		has_port = yes
	}
	modifier = {
		naval_forcelimit = 4
		ship_recruit_speed = -0.50
		local_ship_repair = 0.50
		local_has_man_of_war = yes
		local_has_galleass = yes
	}

	make_obsolete = shipyard
	modifier = {
		ship_recruit_speed = -0.5
		local_ship_repair = 0.5
		#Moved naval_forcelimit to dock and drydock since faster build and repair speed already makes this building worthwhile.		
	}
	on_built = {
		add_development_from_upgrading_or_building = {
			building = grand_shipyard
			obsolete_building = shipyard
			type = production
			value = 2
			upgrade_value = 1
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = grand_shipyard
			type = production
			value = 2
		}
		if = {
			limit = { has_province_modifier = sca_swe_danish_shipyard }
			remove_province_modifier = sca_swe_danish_shipyard
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 6.5
		
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 400 } }
        }
		
		#SPECIFIC
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1200 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 2000 }
		}
		
		#GENERAL
		#Running total 216
		modifier = {
			factor = 1.2			
			FROM = { navy_size_percentage = 0.75 }
		}
		
		#Running total 280.8
		modifier = {
			factor = 1.3			
			FROM = { navy_size_percentage = 1.0 }
		}
		
		#Running total 393.12
		modifier = {
			factor = 1.4			
			FROM = { navy_size_percentage = 1.25 }
		}
		
		#Running total 589.68
		modifier = {
			factor = 1.5			
			FROM = { navy_size_percentage = 1.5 }
		}
		
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 0.75
			NOT = { FROM = { navy_tradition = 20 } }			
		}
		
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 0.9
			NOT = { FROM = { navy_tradition = 40 } }			
		}
		
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 1.1
			FROM = { navy_tradition = 60 }			
		}
		
		#Naval tradition now either encourages or discourages building shipyards
		modifier = {
			factor = 1.25
			FROM = { navy_tradition = 80 }			
		}
		
		#Heavy handed attempt to encourage historical naval powers
		modifier = {
			factor = 1.5
			FROM = {
				OR = {			
					culture_group = british			#The second empire on which the sun never sets
					culture_group = iberian			#The first empire on which the sun never sets
					primary_culture = dutch			#Punched massively above its weight on the sea during this period
					primary_culture = venetian			#Remnants of Mediterranean hegemonies and great naval traditions
					primary_culture = ligurian			#Remnants of Mediterranean hegemonies and great naval traditions
				}
			}
		}
		
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 0.65
			local_autonomy = 40
		}
		
		modifier = {
			factor = 0.65
			is_state = no
		}
		#Xorme
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		#FROM AUTONOMY
		modifier = {
			factor = 0
			FROM = {
				NOT = { navy_size_percentage = 0.9 }
			}
		}
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0.4
			local_autonomy = 75
		}
		modifier = {
			factor = 0.6
			local_autonomy = 50
		}
		modifier = {
			factor = 0.8
			local_autonomy = 25
		}
		#FROM UPGRADE
		modifier = {
			factor = 25.0
			has_building = shipyard
		}
		#FROM BASE DEV
		modifier = {
			factor = 3.0
			FROM = { num_of_ports = 5 }
		}
		modifier = {
			factor = 6.0
			FROM = { num_of_ports = 10 }
		}
		modifier = {
			factor = 9.0
			FROM = { num_of_ports = 15 }
		}
		modifier = {
			factor = 10.0
			NOT = { development = 7 }
		}
		#BUILDINGS
		modifier = {
			factor = 10.0
			xorme_has_production_buildings_trigger = yes
		}
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
		modifier = {
			factor = 100.0
			num_free_building_slots = 3
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

#Tier 1 Navy - Dock
dock = {
	cost = 100
	time = 12
	#Increased cost back to 100 because of the additional naval_forcelimit modifier
	
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
		has_port = yes
	}
	
	modifier = {
		local_sailors_modifier = 0.5
		local_has_man_of_war = yes
		local_has_galleass = yes
	}

	on_built = {
		if = {
			limit = {
				FROM = {
					has_government_attribute = manpower_sailors_on_build
				}
			}
			FROM = {
				add_sailors = 200
			}
		}
		add_development_from_building = {
			building = dock
			type = production
			value = 1
		}
	}

	on_destroyed = {
		if = {
			limit = {
				FROM = {
					has_government_attribute = manpower_sailors_on_build
				}
			}
			FROM = {
				add_sailors = -200
			}
		}
		remove_development_from_building = {
			building = dock
			type = production
			value = 1
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 1
		
		#Better AI Economy
        
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
		#AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 200 } }
        }
		
		#GENERAL
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 0.5
			NOT = { FROM = { navy_tradition = 20 } }			
		}
		
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 0.8
			NOT = { FROM = { navy_tradition = 40 } }			
		}
		
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 1.2
			FROM = { navy_tradition = 60 }			
		}
		
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 1.5
			FROM = { navy_tradition = 80 }			
		}
		
		#Further encouraged if low on sailors
		modifier = {
			factor = 1.2
			NOT = { owner = { sailors_percentage = 0.35 } }			
		}
		
		#Slightly discouraged if plenty of sailors
		modifier = {
			factor = 0.9
			owner = { sailors_percentage = 0.8 }			
		}
		
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 0.65
			local_autonomy = 40
		}
		
		modifier = {
			factor = 0.65
			is_state = no
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 0.5
		}
		modifier = {
			factor = 100.0
			num_free_building_slots = 5
		}
	}
}



#Tier 2 Navy - Drydock
drydock = {
	cost = 300
	time = 12
	#VU cost changed from 300. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces)
	#VU time changed from 12. Doubling second level military buildings build time.

	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
		has_port = yes
	}

	modifier = {
		local_sailors_modifier = 1.0
		local_has_man_of_war = yes
		local_has_galleass = yes
	}

	on_built = {
		if = {
			limit = {
				FROM = {
					has_reform = corvee_reform
				}
			}
			FROM = {
				add_sailors = 200
			}
		}
		add_development_from_upgrading_or_building = {
			building = drydock
			obsolete_building = dock
			type = production
			value = 2
			upgrade_value = 1
		}
	}

	on_destroyed = {
		if = {
			limit = {
				FROM = {
					has_government_attribute = manpower_sailors_on_build
				}
			}
			FROM = {
				add_sailors = -200
			}
		}
		remove_development_from_building = {
			building = drydock
			type = production
			value = 2
		}
	}

	make_obsolete = dock
	modifier = {
		naval_forcelimit = 2
		local_sailors_modifier = 1.0
	}
	on_obsolete = {
	}


	ai_will_do = {
		factor = 1
		
		#Better AI Economy
        
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
		#AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 400 } }
        }
		
		#GENERAL		
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 0.5
			NOT = { FROM = { navy_tradition = 20 } }			
		}
		
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 0.8
			NOT = { FROM = { navy_tradition = 40 } }			
		}
		
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 1.2
			FROM = { navy_tradition = 60 }			
		}
		
		#Naval tradition now either encourages or discourages building docks
		modifier = {
			factor = 1.5
			FROM = { navy_tradition = 80 }			
		}
		
		#Further encouraged if low on sailors
		modifier = {
			factor = 1.2
			NOT = { owner = { sailors_percentage = 0.35 } }			
		}
		
		#Slightly discouraged if plenty of sailors
		modifier = {
			factor = 0.9
			owner = { sailors_percentage = 0.8 }			
		}
		
		#Non-economic buildings get some penalties in high autonomy regions. This is intended to prevent situations caused by the AI not understand how to prioritise non-economic buildings in high autonomy regions due to factoring being forced and not dynamic.
		modifier = {
			factor = 0.65
			local_autonomy = 40
		}
		
		modifier = {
			factor = 0.65
			is_state = no
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}

		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
	}
}
################################################

### GOVERNMENT

#Tier 1 Government - Courthouse
courthouse = {
	cost = 100
	time = 12
	#Changed price back to 100 to avoid AI building this when it doesn't need to.
	
	#VU 13 added to balance states territories and tradecompanies.
	build_trigger = { 
		is_state = yes
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	
	modifier = {
		local_state_maintenance_modifier = -0.25
		local_autonomy = -0.1
		local_governing_cost = -0.25
		allowed_num_of_buildings = 1
	}

	on_built = {
		add_development_from_building = {
			building = courthouse
			type = tax
			value = 1
		}
		if = { 
			limit = { 
				FROM = { has_country_flag = fra_courthouse_bonus_flag }
			}
			add_province_modifier = {
				name = fra_improved_court_houses_modifier
				duration = -1 
			}
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = courthouse
			type = tax
			value = 1
		}
		remove_province_modifier = fra_improved_court_houses_modifier
	}
	on_obsolete = {
	}
	ai_will_do = {
		factor = 15

		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
		#AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 200 } }
        }
		
		#SPECIFIC
		#AI less likely to build in provinces with low development
		modifier = {
			factor = 0.5
			NOT = { development = 6	}			
		}
		
        #AI more likely to build in provinces with high development
        modifier = {
            factor = 2.5
            development = 15
        }
        modifier = {
            factor = 2.5
            development = 21
        }
        modifier = {
            factor = 2.5
            development = 30
        }
		
		#AI less likely to build if autonomy is too low
		modifier = {
			factor = 0.75
			NOT = { local_autonomy = 10 }			
		}
		
		#AI more likely to build if autonomy is too high
		modifier = {
			factor = 1.5
			local_autonomy = 20
		}
		modifier = {
			factor = 1.5
			local_autonomy = 40
		}
		modifier = {
			factor = 1.5
			local_autonomy = 60
		}
		modifier = {
			factor = 1.5
			local_autonomy = 85			
		}
		
		#AI less likely to build if it still has plenty of governing capacity
		modifier = {
			factor = 0.5
			owner = { NOT = { governing_capacity_percentage = 0.5 } }
		}
		modifier = {
			factor = 0.75
			owner = { NOT = { governing_capacity_percentage = 0.7 } }
		}
		
		#AI more likely to build if approaching or over governing capacity
		modifier = {
			factor = 5.0
			owner = { governing_capacity_percentage = 0.8 }
		}
		modifier = {
			factor = 10.0
			owner = { governing_capacity_percentage = 1.0 }
		}
		modifier = {
			factor = 15.0
			owner = { governing_capacity_percentage = 1.1 }
		}
		
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 400 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1000 }
		}
		
		#AI more likely to build if it's a big nation
		modifier = {
			factor = 1.5
			owner = { total_development = 1000 }
		}
		modifier = {
			factor = 1.5
			owner = { total_development = 2000 }
		}
		modifier = {
			factor = 1.5
			owner = { total_development = 3000 }
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 0
			area_for_scope_province = {
				is_capital_of = FROM
			}
		}
		modifier = {
			factor = 0.25
			num_free_building_slots = 2
		}
		#FROM AUTONOMY
		modifier = {
			factor = 1.5
			local_autonomy = 25
		}
		modifier = {
			factor = 3.0
			local_autonomy = 50
		}
		modifier = {
			factor = 4.5
			local_autonomy = 75
		}
		#FROM GOV CAP
		modifier = {
			factor = 5.0
			FROM = { governing_capacity_percentage = 0.9 }
		}
		modifier = {
			factor = 10.0
			FROM = { governing_capacity_percentage = 1.0 }
		}
		modifier = {
			factor = 15.0
			FROM = { governing_capacity_percentage = 1.1 }
		}
		#Xorme
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

#Tier 2 Government - Town Hall
town_hall = {
	cost = 200
	time = 12
	#VU changed from 12. Doubling upgraded buildings' build time.
	
	#VU 13 added to balance states territories and tradecompanies.
	build_trigger = {
		is_state = yes
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}

	make_obsolete = courthouse
	modifier = {
		local_state_maintenance_modifier = -0.5
		local_autonomy = -0.2
		local_governing_cost = -0.5
		allowed_num_of_buildings = 1
	}

	on_built = {
		add_development_from_upgrading_or_building = {
			building = town_hall
			obsolete_building = courthouse
			type = tax
			value = 2
			upgrade_value = 1
		}
		if = { 
			limit = { 
				FROM = { has_country_flag = fra_courthouse_bonus_flag }
				NOT = { has_province_modifier = fra_improved_court_houses_modifier }
			}
			add_province_modifier = {
				name = fra_improved_court_houses_modifier
				duration = -1 
			}
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = town_hall
			type = tax
			value = 2
		}
		remove_province_modifier = fra_improved_court_houses_modifier 
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 25.0

		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
		#AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 400 } }
        }
		
		#SPECIFIC
		#AI less likely to build in provinces with low development
		modifier = {
			factor = 0.5
			NOT = { development = 6	}			
		}
		
        #AI more likely to build in provinces with high development
        modifier = {
            factor = 2.5
            development = 15
        }
        modifier = {
            factor = 2.5
            development = 21
        }
        modifier = {
            factor = 2.5
            development = 30
        }
		
		#AI less likely to build if autonomy is too low
		modifier = {
			factor = 0.75
			NOT = { local_autonomy = 10 }			
		}
		
		#AI more likely to build if autonomy is too high
		modifier = {
			factor = 1.5
			local_autonomy = 20
		}
		modifier = {
			factor = 1.5
			local_autonomy = 40
		}
		modifier = {
			factor = 1.5
			local_autonomy = 60
		}
		modifier = {
			factor = 1.5
			local_autonomy = 85			
		}
		
		#AI less likely to build if it still has plenty of governing capacity
		modifier = {
			factor = 0.5
			owner = { NOT = { governing_capacity_percentage = 0.5 } }
		}
		modifier = {
			factor = 0.75
			owner = { NOT = { governing_capacity_percentage = 0.7 } }
		}
		
		#AI more likely to build if approaching or over governing capacity
		modifier = {
			factor = 5.0
			owner = { governing_capacity_percentage = 0.8 }
		}
		modifier = {
			factor = 10.0
			owner = { governing_capacity_percentage = 1.0 }
		}
		modifier = {
			factor = 15.0
			owner = { governing_capacity_percentage = 1.1 }
		}
		
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1200 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 2000 }
		}
		
		#AI more likely to build if it's a big nation
		modifier = {
			factor = 1.5
			owner = { total_development = 1000 }
		}
		modifier = {
			factor = 1.5
			owner = { total_development = 2000 }
		}
		modifier = {
			factor = 1.5
			owner = { total_development = 3000 }
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 0
			area_for_scope_province = {
				is_capital_of = FROM
			}
		}
		modifier = {
			factor = 0.25
			num_free_building_slots = 2
		}
		#FROM AUTONOMY
		modifier = {
			factor = 1.5
			local_autonomy = 25
		}
		modifier = {
			factor = 3.0
			local_autonomy = 50
		}
		modifier = {
			factor = 4.5
			local_autonomy = 75
		}
		#FROM UPGRADE
		modifier = {
			factor = 25.0
			has_building = courthouse
		}
		#FROM GOV CAP
		modifier = {
			factor = 5.0
			FROM = { governing_capacity_percentage = 0.9 }
		}
		modifier = {
			factor = 10.0
			FROM = { governing_capacity_percentage = 1.0 }
		}
		modifier = {
			factor = 15.0
			FROM = { governing_capacity_percentage = 1.1 }
		}
		#Xorme
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

#Tier 1 Government - University
university = {
	cost = 300
	time = 12
	#VU price changed from 300. This is late game, vital to the spread of the enlightenment, and generally very important.
	#Furthermore the development of centres of learning and scholarship was more expensive and time consuming than one might think.
	#Changing cost and time to be closer to/higher than the earlier manufactories.
	#Note I'll also increase the enlightenment spread from a uni, so this becomes something to be built in key cities & let spread, not something to spam everywhere at tech 17 for tech spread and dev cost.
	#VU changed from 12. This is not meant to be spammed when the enlightenment hits to catch up, increased to 4y
	
	modifier = {
		local_institution_spread = 1.0
		#Changed from 0.5 to better represent that universities were often the birthplace of scientific advancements and innovation.
		
		local_development_cost = -0.25
		#Brought back local_development_cost and removed those tax and production modifier.
		#OP really said "Universities do encourage complex economic systems, advanced industry, and improved production methods" in the same line as "I wouldn't say universities aid development".
	}

	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}

	modifier = {
		local_development_cost = -0.20
		allowed_num_of_buildings = 1
	}

	on_built = {
		add_development_from_building = {
			building = university
			type = tax
			value = 2
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = university
			type = tax
			value = 2
		}
	}
	on_obsolete = {
	}

	#Neart perfect copy because I'm not spending my time organising this. Economy 101 was shoved at the end.
	ai_will_do = {
		# Hard coded AI sees no value in this above the 0.01 ducats base. Let's multiply that
		factor = 25.0 #VU Addon changed from 1. Changing all base factors to price divided by 100. Base of 0.01 ducats per MONTH 
		#VU Addon cut a bunch of... not horrible but not great AI code here encouraging unis to be built. Replacing it below. Vanilla range was 36 percent to 7,500 percent.
		#Note with this addon, universities are no longer economically worthless, and I am assuming the AI will pick up on that. I do not know, however, what the exact figures are and thus balancing it will be a challenge. For a start, it has roughly half the economic contribution of a cathedral, but x3 the cost,
		#assuming the new AI is not smart enough to pick up on institution spread modifiers, which do not exist in vanilla, without any other modifiers I'm assuming (notice a trend here?) that it will require a factor of 6 or so before the AI will choose this before a cathedral or a factor of 12 to pick before a temple.
		#VU Addon New factors, range (roughly) 0.0001 percent to over 50,000 percent. Note vanilla range was 36 percent to 7,500 percent.
		################################################################################
		###############		Using tech groups to establish base factors of 0.3 to 4		###############
		################################################################################
		modifier = {
			factor = 0.3			#One 20th of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much as I love the concept of a bustling university discovering advanced scientific principles while speaking Maori or something equally absurd/obscure, the fact is some technology groups simply did not have the infrastructure, history, or circumstance to evolve in this way. Making it very unlikely
		modifier = {
			factor = 1			#One 6th of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 2			#One 3rd of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 3			#half of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = {
				OR = {
					technology_group = eastern
					technology_group = high_american
				}
			}
		}	#Medium range for eastern, and throwing in High American for fun as this is effectively the default level.
		modifier = {
			factor = 4			#Two 3rds of 6, which is what it would require to roughly match a cathedral in priority with no other modifiers
			FROM = { technology_group = western }
		}	#The concept of a university may or may not be a uniquely western concept, but in this specific period, it was a western reality, less so elsewhere. Though as a point of interest, universities were a very different beast in this period than the BA most modern people think of.
		################################################################################
		###############		Various bonuses and penalties to make things dynamic		###############
		################################################################################
		#Note that IN THEORY, without any other modifiers, it would require....
		#About 4 of the 1.4 bonuses for Muslim or Ottoman tech to build a uni before a cathedral and all 6 to be a higher priority than a temple,
		#all 6 1.4 bonuses for other Old World techs to build a uni before a cathedral and they will never place it above a temple,
		#New World techs will effectively never build unis without player intervention,
		#eastern requires about 3 of the 1.4 bonuses to place them as a higher priority than cathedrals or 5 of the 1.4 bonuses to be a higher priority than a temple,
		#and western will place them at a higher priority than cathedrals with 2 1.4 bonuses. or a higher priority than temples with 4 1.4 bonuses.
		#Once 5 universities are built, the AI will be less likely to build more.
		modifier = {
			factor = 1.4
			FROM = { ruler_has_personality = scholar_personality }
		}
		modifier = {
			factor = 1.4
			FROM = { advisor = natural_scientist }
		}
		modifier = {
			factor = 1.4
			FROM = { advisor = philosopher }
		}
		modifier = {
			factor = 1.4
			FROM = { full_idea_group = innovativeness_ideas }
		}
		modifier = {
			factor = 1.4
			FROM = { is_great_power = yes }			#Primarily to keep Russia, Poland, and Ottomans in line with western, and the top western powers ahead of everyone else, as real history went, but also may potentially help China, India, or any ahistorical superpower in Asia or Africa as well.
		}
		modifier = {
			factor = 1.4
			province_has_center_of_trade_of_level = 1			#Cheap shortcut method to try to get unis in plausible rich centers, especially for alt history non-european unis.
		}
		modifier = {
			factor = 1.18			#Half strength
			num_of_times_improved = 10
		}	#A province which has been developed intensely is slightly more likely to get a uni
		modifier = {
			factor = 10
			is_institution_origin = enlightenment
		}
		modifier = {
			factor = 0.2
			FROM = {
				num_of_owned_provinces_with = {
					value = 5
					OR = {
						has_building = university
						has_construction = university
					}
					is_core = PREV			#I'm useless with coding =p. Do I need PREV or ROOT here, or will either work?
				}
			}
		}	#If the owner has 5 cores with unis already, make it less likely to build more
		modifier = {
			factor = 0.2
			any_neighbor_province = {
				has_building = university
			}
		}	#Hopefully this doesn't make the engine go too insane. From a gameplay perspective, this is huge at distributing enlightenment spreaders evenly. Could also try to do something area related, but with the other factors below this should suffice.
		####################################################################################################
		##########	Effectively disabling unis for fringes, harsh climates, minorities, and non western minors 	##########
		####################################################################################################
		modifier = {
			factor = 0.1
			FROM = {
				NOT = { technology_group = western }
				NOT = { technology_group = eastern }
				NOT = { total_development = 200 }
			}	#Small non European AI countries shouldn't build many unis, further penalty even beyond the tech group penalty above.
		}
		modifier = {
			factor = 0.5
			is_in_capital_area = no
		}			#AI should rarely build uni in a province which is not connected to the capital by land. This could cause some issues in the extremely rare cases of thalassocracies, but it fixes far more problems than it creates, so leaving it.
		modifier = {
			factor = 0.1
			is_state = no
		}			#AI should almost never build uni in a province which is not a state
		modifier = {
			factor = 0.1
			has_owner_culture = no
			has_owner_accepted_culture = no
		}			#AI should almost never build uni in a province with a different culture, even if that culure is accepted
		modifier = {
			factor = 0.33
			has_owner_culture = no
			has_owner_accepted_culture = yes
		}			#Though an accepted culture is still more likely than a non accepted culture
		modifier = {
			factor = 0.1
			has_owner_religion = no
		}			#AI should almost never build uni in a province with a different religion, even if there is positive tolerance.
		modifier = {
			factor = 0.1
			OR = {
				has_climate = tropical
				has_climate = arctic
				has_climate = arid
			}
		}	#AI should almost never build uni in a province with a hostile climate. This may hurt the chances of some small countries who only own land in these climate types, but well... they really shouldn't be building too many unis anyway, with very, very few exceptions. As in none I can think of
		################################################################################
		###############	Almost guaranteeing unis in provinces with real historical universities	###############
		################################################################################
		modifier = {
			factor = 20
			OR = {
				province_id = 4730		#Bologna, 1088
				province_id = 237			#Oxford, 1096
				province_id = 183			#Paris (Sorbonne), 1160 (I thought it was older...)
				province_id = 3027		#Cambrige, 1209
				province_id = 216			#Salamanca, 1218
				province_id = 108			#Padua (actually Verona atm, might add some provinces to Italy in the future), 1222 or older
				province_id = 121			#Naples, 1224
				province_id = 196			#Toulouse, 1229
				province_id = 200			#Montpellier, 1289
				province_id = 119			#Macerata (Ancona), 1290
				province_id = 1851		#Coimbra (actually started in Lisbon and moved to Coimbra in 1537, but whatever), 1290
				province_id = 217			#Alcala (Madrid), 1293
				province_id = 118			#Rome, 1303
				province_id = 2976		#Perugia (Umbria), 1308
				province_id = 116			#Florence, 1321
				province_id = 115			#Pisa, 1343
				province_id = 266			#Prague, 1348
				province_id = 4728		#Pavia, 1361
				province_id = 262			#Jagiellonian (Krakow), 1364
				province_id = 134			#Vienna, 1365
				province_id = 77			#Ruprecht Karl University of Heidelberg, 1386
				province_id = 113			#Ferrara, 1391
				province_id = 103			#Turin, 1404
				province_id = 117			#Siena, 1408
				province_id = 62			#Leipzig, 1409
				province_id = 250			#St. Andrews (Fife), 1413
				province_id = 46			#Rostock, 1419
				province_id = 168			#Caen, 1432
				province_id = 124			#Catania (Mesina), 1434
			}
		}			#Few little nudges to history to try to encourage the main historical universities (Which actually exisited prior to our start date) to be 'built' in the proper provinces first. For Unis founded after our 1444 start date, I'm not doing anything. There are several more which no longer exist, but for those I have to figure out when they closed, so not doing them now.
		################################################################################
		##########	End of the insanely overcomplicated uni AI controls by VU's Misc Addon	##########
		################################################################################
		#P.S. Sorry I got carried away, hopefully the engine doesn't blow up calculating all these.
		
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 800 } }
        }
		
		#AI less likely to build in provinces with low development
		modifier = {
			factor = 0.1
			NOT = { development = 9 }
		}
		
		#AI more likely to build in provinces with high development
        modifier = {
            factor = 1.18
            development = 21
        }
		
		#AI more likely to build when rich
		modifier = {
			factor = 1.1
			owner = { treasury = 1600 }
		}
		modifier = {
			factor = 1.2
			owner = { treasury = 2400 }
		}
		modifier = {
			factor = 1.3
			owner = { treasury = 3200 }
		}
		modifier = {
			factor = 1.4
			owner = { treasury = 4000 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1400 }
		}
		#Xorme FROM AUTONOMY
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 0
			is_state = no
		}
		#FROM BASE DEV
		modifier = {
			factor = 0.5
			NOT = { development = 20 }
		}
		#FROM AUTONOMY
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0.4
			local_autonomy = 75
		}
		modifier = {
			factor = 0.6
			local_autonomy = 50
		}
		modifier = {
			factor = 0.8
			local_autonomy = 25
		}
		#FROM BASE DEV
		modifier = {
			factor = 10.0
			development = 20
		}
		modifier = {
			factor = 20.0
			development = 30
		}
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

################################################

### TAXATION

#Tier 1 Taxation - Temple
temple = {
	cost = 100
	time = 12
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	modifier = {
		local_tax_modifier = 0.4
	}
	on_built = {
		if = {
			limit = {
				FROM = {
					OR = {
						religion = buddhism
						religion = mahayana
						religion = vajrayana
					}
					has_estate_privilege = estate_church_karma_temples
				}
			}
			FROM = {
				add_karma = 3
			}
		}
		if = {
			limit = {
				FROM = {
					religion = catholic
					has_estate_privilege = estate_church_influence_temples
				}
			}
			FROM = {
				add_papal_influence = 3
			}
		}
		on_province_tax_building_built_estate_privileges_effect = yes
		add_development_from_building = {
			building = temple
			type = tax
			value = 1
		}
		if = {
			limit = {
				FROM = { has_government_attribute = on_church_built_clergy_loyalty }
			}
			FROM = {
				add_estate_loyalty = {
					estate = estate_church
					loyalty = 2
				}
			}
		}
		if = {
			limit = {
				FROM = { has_government_attribute = temples_modifier }
				owned_by = FROM 
			}
			add_province_modifier = {
				name = gov_expanded_temple_rights_mod
				duration = -1
			}
		}
	}
	
	on_destroyed = {
		if = {
			limit = {
				FROM = {
					OR = {
						religion = buddhism
						religion = mahayana
						religion = vajrayana
					}
					has_estate_privilege = estate_church_karma_temples
				}
			}
			FROM = {
				add_karma = -3
			}
		}
		if = {
			limit = {
				FROM = {
					religion = catholic
					has_estate_privilege = estate_church_influence_temples
				}
			}
			FROM = {
				add_papal_influence = -3
			}
		}
		on_province_tax_building_destroyed_estate_privileges_effect = yes
		remove_development_from_building = {
			building = temple
			type = tax
			value = 1
		}
		if = {
			limit = {
				FROM = { has_government_attribute = on_church_built_clergy_loyalty }
			}
			FROM = {
				add_estate_loyalty = {
					estate = estate_church
					loyalty = -2
				}
			}
		}
		remove_province_modifier = gov_expanded_temple_rights_mod
	}
	on_obsolete = {
	}
	
	modifier = {
		local_missionary_strength = 0.01
		#VU new effect. Giving the temple the same bonus of this building's upgrade, simply weaker. Makes it more useful when it is too late in the game to make money back from building cost.
		
		local_tax_modifier = 0.5
		#Changed this from 0.3 to 0.5 since temples were really not worth it from an economic POV. Higher taxation should make it worthwhile in high dev provinces.
	}

	ai_will_do = {
		factor = 2.5

		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 200 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		modifier = {
			factor = 1.5
			base_tax = 3
		}
		modifier = {
			factor = 3.5
			base_tax = 5
		}
		modifier = {
			factor = 6.5
			base_tax = 7
		}
		
		#GENERAL
		#AI is encouraged to build this where they need to convert the local population
		modifier = {
			factor = 1.5
			has_owner_religion = no			
		}
		
		#Theocracies will build more temples.
		modifier = {
			factor = 2.0
			FROM = { government = theocracy }			
		}
		#Xorme FROM AUTONOMY
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0
			OR = {
				FROM = { num_of_loans = 1 }
			}
		}
		#FROM AUTONOMY
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0.4
			local_autonomy = 75
		}
		modifier = {
			factor = 0.6
			local_autonomy = 50
		}
		modifier = {
			factor = 0.8
			local_autonomy = 25
		}
		#FROM BASE DEV
		modifier = {
			factor = 3.0
			base_tax = 4
		}
		modifier = {
			factor = 6.0
			base_tax = 6
		}
		modifier = {
			factor = 9.0
			base_tax = 8
		}
		#FROM TRADE GOODS
		modifier = {
			factor = 5.0
			xorme_province_with_special_goods_produced_trigger = yes
		}
		modifier = {
			factor = 10.0
			xorme_high_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 15.0
			xorme_medium_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 20.0
			xorme_low_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 25.0
			xorme_lowest_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
		modifier = {
			factor = 100.0
			num_free_building_slots = 3
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}



#Tier 2 Taxation - Cathedral
cathedral = {
	cost = 300
	time = 12
	
	#VU changed price from 300. Part of the comprehensive balance overhaul to adjust buildings to the VU map (with all its new provinces).
	#VU changed from 12. Doubling upgraded buildings' build time.

	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}

	modifier = {
		local_missionary_strength = 0.03
		local_tax_modifier = 0.6
	}
	on_built = {
		on_province_tax_building_built_estate_privileges_effect = yes
		add_development_from_upgrading_or_building = {
			building = cathedral
			obsolete_building = temple
			type = tax
			value = 2
			upgrade_value = 1
		}
		if = {
			limit = {
				FROM = { has_government_attribute = on_church_built_clergy_loyalty }
			}
			FROM = {
				add_estate_loyalty = {
					estate = estate_church
					loyalty = 5
				}
			}
		}
		if = {
			limit = {
				FROM = { has_government_attribute = temples_modifier }
			}
			add_province_modifier = {
				name = gov_expanded_temple_rights_mod
				duration = -1
			}
		}
		if = {
			limit = {
				FROM = {
					OR = {
						religion = buddhism
						religion = mahayana
						religion = vajrayana
					}
					has_estate_privilege = estate_church_karma_temples
				}
			}
			FROM = {
				add_karma = 3
			}
		}
		if = {
			limit = {
				FROM = {
					religion = catholic
					has_estate_privilege = estate_church_influence_temples
				}
			}
			FROM = {
				add_papal_influence = 3
			}
		}
	}
	
	on_destroyed = {
		if = {
			limit = {
				FROM = {
					OR = {
						religion = buddhism
						religion = mahayana
						religion = vajrayana
					}
					has_estate_privilege = estate_church_karma_temples
				}
			}
			FROM = {
				add_karma = -3
			}
		}
		if = {
			limit = {
				FROM = {
					religion = catholic
					has_estate_privilege = estate_church_influence_temples
				}
			}
			FROM = {
				add_papal_influence = -3
			}
		}
		on_province_tax_building_destroyed_estate_privileges_effect = yes
		remove_development_from_building = {
			building = cathedral
			type = tax
			value = 3
		}
		if = {
			limit = {
				FROM = { has_government_attribute = on_church_built_clergy_loyalty }
			}
			FROM = {
				add_estate_loyalty = {
					estate = estate_church
					loyalty = -5
				}
			}
		}
		remove_province_modifier = gov_expanded_temple_rights_mod
	}
	on_obsolete = {
	}
	
	make_obsolete = temple
	modifier = {
		local_missionary_strength = 0.02
		local_tax_modifier = 1.0
	}

	ai_will_do = {
		factor = 5
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		modifier = {
			factor = 1.5
			base_tax = 3
		}
		modifier = {
			factor = 3.5
			base_tax = 5
		}
		modifier = {
			factor = 6.5
			base_tax = 7
		}
		
		#GENERAL		
		#AI is encouraged to build this where they need to convert the local population
		modifier = {
			factor = 1.5
			has_owner_religion = no			
		}
		
		#Theocracies will build more temples.
		modifier = {
			factor = 2.0
			FROM = { government = theocracy }			
		}
		#Xorme FROM BUILDINGS
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		#FROM BUILDINGS
		modifier = {
			factor = 0.05
			OR = {
				NOT = { num_free_building_slots = 2 }
				xorme_has_production_buildings_trigger = no
			}
		}
		#FROM AUTONOMY
		modifier = {
			factor = 0.4
			local_autonomy = 75
		}
		modifier = {
			factor = 0.6
			local_autonomy = 50
		}
		modifier = {
			factor = 0.8
			local_autonomy = 25
		}
		#FROM BASE DEV
		modifier = {
			factor = 3.0
			base_tax = 4
		}
		modifier = {
			factor = 6.0
			base_tax = 6
		}
		modifier = {
			factor = 9.0
			base_tax = 8
		}
		#FROM UPGRADE
		modifier = {
			factor = 25.0
			has_building = temple
		}
		#FROM TRADE GOODS
		modifier = {
			factor = 5.0
			xorme_province_with_special_goods_produced_trigger = yes
		}
		modifier = {
			factor = 10.0
			xorme_high_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 15.0
			xorme_medium_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 20.0
			xorme_low_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 25.0
			xorme_lowest_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 100.0
			has_province_modifier = xorme_ai_agenda_building_spot
		}
		modifier = {
			factor = 100.0
			num_free_building_slots = 3
		}
		#FROM CASH
		modifier = {
			factor = 100.0
			FROM = {
				treasury = 7500
			}
		}
	}
}

#Tier 3 Taxation - Grand Cathedral
grand_cathedral = {
	cost = 400
	time = 36

	on_built = {
		if = {
			limit = {
				FROM = {
					OR = {
						religion = buddhism
						religion = mahayana
						religion = vajrayana
					}
					has_estate_privilege = estate_church_karma_temples
				}
			}
			FROM = {
				add_karma = 3
			}
		}
		if = {
			limit = {
				FROM = {
					religion = catholic
					has_estate_privilege = estate_church_influence_temples
				}
			}
			FROM = {
				add_papal_influence = 3
			}
		}
	}
	
	on_destroyed = {
		if = {
			limit = {
				FROM = {
					OR = {
						religion = buddhism
						religion = mahayana
						religion = vajrayana
					}
					has_estate_privilege = estate_church_karma_temples
				}
			}
			FROM = {
				add_karma = -3
			}
		}
		if = {
			limit = {
				FROM = {
					religion = catholic
					has_estate_privilege = estate_church_influence_temples
				}
			}
			FROM = {
				add_papal_influence = -3
			}
		}
	}
	
	make_obsolete = cathedral
	modifier = {
		local_missionary_strength = 0.05
		local_tax_modifier = 2.0
	}

	ai_will_do = {
		factor = 6
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 800 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		modifier = {
			factor = 1.5
			base_tax = 3
		}
		modifier = {
			factor = 3.5
			base_tax = 5
		}
		modifier = {
			factor = 6.5
			base_tax = 7
		}
		
		#GENERAL		
		#AI is encouraged to build this where they need to convert the local population
		modifier = {
			factor = 1.5
			has_owner_religion = no			
		}
		
		#Theocracies will build more temples.
		modifier = {
			factor = 2.0
			FROM = { government = theocracy }			
		}
	}
}

################################################

### TRANSPORTATION

#Tier 1 Transportation - Road System
road_system = {
	cost = 50
	time = 6
	
	modifier = {
		local_friendly_movement_speed = 0.15
		#Changed from 0.2 so it combines nicely with roads and railways for 50% and 100% bonuses.
		
		local_institution_spread = 0.1
		#Any infrastructure that allows for an easier flow of people and goods subsequently allows for an easier flow of information. This should represent that.
		
		local_development_cost = -0.1
		#Roads moderately improved the development of any cities it connected to by facilitating the transport of people and goods substantially.
		
		allowed_num_of_buildings = 1
		#This allows for improved transportation between urban and rural areas, so buildings can be made when otherwise they would be too far to get to.
	}

	ai_will_do = {
		factor = 50
		modifier = {
			factor = 0.1
			is_overseas = yes
			NOT = { development = 10 }
		}
		
		modifier = {
			factor = 0.1
			is_overseas = yes
			NOT = { development = 10 }
		}
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 100 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		
		#GENERAL
		#AI is encouraged to build nearby others, this is done to avoid roads that lead nowhere.
		modifier = {
			factor = 2
			any_neighbor_province = {
				has_building = road_system
			}
		}
		
		#AI is encouraged to build in capitals.
		modifier = {
			factor = 2.5
			is_capital = yes
		}
	}
}

#Tier 1 Transportation - Canal System
canal_system = {
	cost = 100
	time = 12
	
	make_obsolete = road_system
	modifier = {
		local_friendly_movement_speed = 0.25
		#Changed from 0.2 so it combines nicely with canals and railways for 50% and 100% bonuses.
		
		local_institution_spread = 0.2
		#Any infrastructure that allows for an easier flow of people and goods subsequently allows for an easier flow of information. This should represent that.
		
		local_development_cost = -0.15
		#Canals significantly improved the development of any cities it connected to by facilitating the transport of people and goods substantially.
		
		allowed_num_of_buildings = 2
		#This allows for improved transportation between urban and rural areas, so buildings can be made when otherwise they would be too far to get to.
	}
	
	build_trigger = {
		AND = {
			#Can only build if province is coastal or a neighbouring province has it
			OR = {
				has_port = yes
				any_neighbor_province = {
					has_building = canal_system
				}
			}
			
			#Can't build if province has a terrain not suitable for canals
			NOT = {
				has_terrain = hills
				has_terrain = highlands
				has_terrain = mountain
				has_terrain = cold_mountains
				has_terrain = desert_ranges
				has_terrain = dry_highlands
				has_terrain = glacier
				#has_terrain = woods
			}
		}
	}

	ai_will_do = {
		factor = 50
		modifier = {
			factor = 0.1
			is_overseas = yes
			NOT = { development = 10 }
		}
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 200 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		
		#GENERAL
		#AI is encouraged to build nearby others, this is done to avoid roads that lead nowhere.
		modifier = {
			factor = 2
			any_neighbor_province = {
				has_building = canal_system
			}
		}
		
		#AI is encouraged to build in capitals.
		modifier = {
			factor = 2.5
			is_capital = yes
		}
	}
}

#Tier 1 Transportation - Railway System
railway_system = {
	cost = 200
	time = 24
	
	#Changed cost from 400. While railways should be expensive, they shouldn't be as expensive as entire buildings.
	#Changed time from 12 because railways are significantly better than roads and canals.
	
	#Removed the DLC requirements so those that don't have them can still have railways.
	#Change the building triggers to favour terrain restrictions instead of coal production, railway adjacency or rail boom.
	
	build_trigger = {
		#Can't build if province has a terrain not suitable for railways
		#I decided to make that only mountains and glaciers because adding the other canal terrains would make railways worthless in many parts of the world.
		NOT = { has_terrain = mountain }
		NOT = {	has_terrain = cold_mountains }
		NOT = {	has_terrain = glacier }
		NOT = {	has_terrain = swamp }
		NOT = {	has_terrain = tropical_highlands_terrain }
		NOT = {	has_terrain = desert_ranges }
	}
	
	modifier = {
		local_friendly_movement_speed = 0.5
		#Changed from 0.4 so it combines nicely with roads and canals for 50% and 100% bonuses.
		#Should go without saying that railways were the best infrastructure possible at the time, so they have the largest bonus to movement speed.
		
		local_institution_spread = 0.4
		#Any infrastructure that allows for an easier flow of people and goods subsequently allows for an easier flow of information. This should represent that.
		
		local_development_cost = -0.25
		#Railways drastically improved the development of any cities it connected to by facilitating the transport of people and goods substantially.
		
		allowed_num_of_buildings = 3
		#This allows for improved transportation between urban and rural areas, so buildings can be made when otherwise they would be too far to get to.
	}

	ai_will_do = {
		factor = 100
		modifier = {
			factor = 0.1
			is_overseas = yes
			NOT = { development = 10 }
		}
		
		modifier = {
			factor = 0.1
			is_overseas = yes
			NOT = { development = 10 }
		}
		
		#ECONOMY 101
		#AI avoids building with loans
		modifier = {
			factor = 0
			owner = { num_of_loans = 3 }
		}
		modifier = {
			factor = 0.3
			owner = { num_of_loans = 2 }
		}
		modifier = {
			factor = 0.5
			owner = { num_of_loans = 1 }
		}
		
		#AI avoids building when in deficit
		modifier = {
			factor = 0.75
			owner = { is_in_deficit = yes }
		}
		
		#AI will try to stockpile some amount of money
		modifier = {
			factor = 0.75
			owner = { NOT = { treasury = 400 } }
		}
		
		#SPECIFIC
		#AI more likely to build in provinces with high development
		modifier = {
			factor = 2.5
			development = 15
		}
		modifier = {
			factor = 2.5
			development = 21
		}
		modifier = {
			factor = 2.5
			development = 30
		}
		
		#GENERAL
		#AI is encouraged to build nearby others, this is done to avoid roads that lead nowhere.
		modifier = {
			factor = 2
			any_neighbor_province = {
				has_building = railway_system
			}
		}
		
		#AI is encouraged to build in capitals.
		modifier = {
			factor = 2.5
			is_capital = yes
		}
	}
}

################################################

### COASTAL

#Tier 1 Coastal - Naval Base #Coastal Defence
naval_base = {

	cost = 100
	time = 12
	build_trigger = {
		has_port = yes
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	modifier = {
		blockade_force_required = 0.5
		hostile_disembark_speed = 1
		
		hostile_fleet_attrition = 1
		#Added so, firstly, this building is worth it, and secondly, to add a way to counter blockades even if just a little.
		
		block_slave_raid = yes
	}

	ai_will_do = {
		factor = 1
		
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 200 } }
        }
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			has_province_modifier = slaves_raided
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
	}
}

#Tier 2 Coastal - Naval Arsenal #Was naval_battery
naval_arsenal = {

	make_obsolete = coastal_defence
	cost = 200
	time = 12
	
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
		has_port = yes
	}
	
	make_obsolete = naval_base
	modifier = {
		blockade_force_required = 1.0
		hostile_disembark_speed = 2.0
		
		hostile_fleet_attrition = 5
		#Added so, firstly, this building is worth it, and secondly, to add a way to counter blockades even if just a little.
		
		block_slave_raid = yes
	}

	ai_will_do = {
		factor = 1
        
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 400 } }
        }

		modifier = {
			factor = 100.0
			has_province_modifier = slaves_raided
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 10
			has_building = coastal_defence
		}
	}
}

#Tier 3 Coastal - Coastal Artillery
coastal_artillery = {
	cost = 400
	time = 36
	
	build_trigger = {
		has_port = yes
	}
	
	make_obsolete = naval_arsenal
	modifier = {
		blockade_force_required = 2.0
		hostile_disembark_speed = 2.0
		
		hostile_fleet_attrition = 5
		#By now provinces with this should be able to counter the late-game naval powers, but not cripple them.
		
		block_slave_raid = yes
	}

	ai_will_do = {
		factor = 2
		
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 800 } }
        }
	}
}

################################################

### DEFENSE

#Tier 1 Fortification - Castle
fort_15th = {
	cost = 200
	time = 30

	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			OR = {
				is_capital_of = FROM
				all_neighbor_province = {
					NOT = {
						OR = {
							xorme_ai_is_building_fort_trigger = yes
							xorme_ai_has_any_fort_trigger = yes
							has_influencing_fort = yes
						}
					}
				}	
			}
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	
#	# THIS = Province, FROM = Builder(not nessecairly owner, can be overlord)
#	on_built = {
#		FROM = {
#			add_army_professionalism = 0.005
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings made obsolete!
#	on_destroyed = {
#		FROM = {
#			add_army_professionalism = -0.01
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings destroyed!
#	on_obsolete = {
#		hidden_effect = {
#			FROM = {
#				add_army_professionalism = -0.005
#			}
#		}
#	}
	
	modifier = {
		fort_level = 1
		#VU changed from original 2. Fort levels are just ridiculous in vanilla and require far too many cannons, especially at later levels. After some testing, I'm content with my new 1-2-3-5 system.
		
		local_unrest = -0.5
		#VU new. The days of controling a region by building a castle there were largely over by the later EU4 period, but I really like the concept of forts establishing a permanent military presence, much like friendly troops in the province reduce unrest. Also want another bonus to justify cost
		
		local_defensiveness = 0.25
		#VU new. The point of weakening forts isn't to speed up the game, or make conquest easier or faster, but rather to reduce how mandatory cannons and obscenely large armies are for sieges. Local defensiveness slows things back down after reducing fort levels.
	}

	on_built = {
		if = {
			limit = {
				FROM = { NOT = { mil_tech = 14 } has_government_attribute = on_fort_built_nobles_loyalty }
			}
			FROM = {
				if = {
					limit = {
						has_estate = estate_nobles
					}
					add_estate_loyalty = {
						estate = estate_nobles
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_maratha
					}
					add_estate_loyalty = {
						estate = estate_maratha
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_rajput
					}
					add_estate_loyalty = {
						estate = estate_rajput
						loyalty = 5
					}
				}
			}
		}
		if = {
			limit = {
				owner = {
					has_estate_privilege = estate_nobles_development_of_castles
				}
				NOT = { has_province_modifier = estate_nobles_development_of_castles_mod }
			}
			add_province_modifier = {
				name = estate_nobles_development_of_castles_mod
				duration = -1
			}
		}
	}

	on_destroyed = {
		if = {
			limit = {
				FROM = {
					ai = yes
				}
			}
			FROM = { add_treasury = 100 }
		}		
		if = {
			limit = {
				has_province_modifier = estate_nobles_development_of_castles_mod
			}
			remove_province_modifier = estate_nobles_development_of_castles_mod
		}
	}

	# THIS = Province, FROM = Destroyer, Will not be called on buildings destroyed!
	on_obsolete = {
	}

	onmap = yes
	influencing_fort = yes

	ai_will_do = {
		factor = 1.2
        
        #ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 200 } }
        }
		
		#SPECIFIC
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 400 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1000 }
		}
		
		#AI less likely to build forts right next to each other
		modifier = {
			factor = 0.1
			any_neighbor_province = {
				OR = {
					has_building = fort_15th
					has_building = fort_16th
					has_building = fort_17th
					has_building = fort_18th
				}
			}
		}
		
		#GENERAL
		#AI would want to fortify their home province.
		modifier = {
			factor = 2
			is_capital = yes			
		}
		
		#Being a march encourages building forts
		modifier = {
			factor = 1.5
			FROM = { is_march = yes }
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.8
			NOT = { FROM = { army_tradition = 20 } }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.95
			NOT = { FROM = { army_tradition = 40 } }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.05
			FROM = { army_tradition = 60 }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.1
			FROM = { army_tradition = 80 }			
		}
		
		#Partly for gameplay, but Europe became insanely fortified during this period
		modifier = {
			factor = 1.25
			FROM = { technology_group = western }			
		}
		
		#Note Eastern, Ottoman, Muslim, East African, Indian, and Chinese tech groups receive no penalty nor bonus
		
		#Partly for gameplay, but these techs didn't really have the castle-every-100-meters thing going on for the most part
		modifier = {
			factor = 0.75
			FROM = {			
				OR = {
					technology_group = central_african
					technology_group = nomad_group
					technology_group = sub_saharan
					technology_group = north_american
					technology_group = mesoamerican
					technology_group = south_american
					technology_group = andean
				}
			}
		}
		modifier = {
			factor = 1000.0
			is_capital = yes
		}
	}
}

#Tier 2 Fortification - Bastion
fort_16th = {
	cost = 400
	time = 30

	#Price changed back to 400 since this fort is twice as strong as the first.
	#Time changed from 36 to 48 so fort levels are 1y, 2y, 3y and 4y respectively.
	
#	# THIS = Province, FROM = Builder(not nessecairly owner, can be overlord)
#	on_built = {
#		FROM = {
#			add_army_professionalism = 0.01
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings made obsolete!
#	on_destroyed = {
#		FROM = {
#			add_army_professionalism = -0.02
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings destroyed!
#	on_obsolete = {
#		hidden_effect = {
#			FROM = {
#				add_army_professionalism = -0.01
#			}
#		}
#	}
	
	make_obsolete = fort_15th

	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			OR = {
				is_capital_of = FROM
				all_neighbor_province = {
					NOT = {
						OR = {
							xorme_ai_is_building_fort_trigger = yes
							xorme_ai_has_any_fort_trigger = yes
							has_influencing_fort = yes
						}
					}
				}	
			}
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}

	make_obsolete = fort_15th
	modifier = {
		#VU changed from 4
		fort_level = 2
		
		#VU new
		local_unrest = -1.0
		
		#VU new
		local_defensiveness = 0.5
	}

	on_built = {
		if = {
			limit = {
				FROM = { NOT = { mil_tech = 19 } has_government_attribute = on_fort_built_nobles_loyalty }
			}
			FROM = {
				if = {
					limit = {
						has_estate = estate_nobles
					}
					add_estate_loyalty = {
						estate = estate_nobles
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_maratha
					}
					add_estate_loyalty = {
						estate = estate_maratha
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_rajput
					}
					add_estate_loyalty = {
						estate = estate_rajput
						loyalty = 5
					}
				}
			}
		}
		if = {
			limit = {
				owner = {
					has_estate_privilege = estate_nobles_development_of_castles
				}
				NOT = { has_province_modifier = estate_nobles_development_of_castles_mod }
			}
			add_province_modifier = {
				name = estate_nobles_development_of_castles_mod
				duration = -1
			}
		}
	}

	on_destroyed = {
		if = {
			limit = {
				FROM = {
					ai = yes
				}
			}
			FROM = { add_treasury = 200 }
		}
	}
	on_obsolete = {
		if = {
			limit = {
				has_province_modifier = estate_nobles_development_of_castles_mod
			}
			remove_province_modifier = estate_nobles_development_of_castles_mod
		}
	}
	onmap = yes
	influencing_fort = yes

	ai_will_do = {
		factor = 1.4
		
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 400 } }
        }
		
		#SPECIFIC
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1200 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 1600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 2000 }
		}
		
		#AI less likely to build forts right next to each other
		modifier = {
			factor = 0.1
			any_neighbor_province = {
				OR = {
					has_building = fort_15th
					has_building = fort_16th
					has_building = fort_17th
					has_building = fort_18th
				}
			}
		}
		
		#GENERAL
		#AI would want to fortify their home province.
		modifier = {
			factor = 2
			is_capital = yes			
		}
		
		#VU Addon New factors, range 51 percent to 216.5625 percent
		
		#Being a march encourages building forts
		modifier = {
			factor = 1.5
			FROM = { is_march = yes }
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.8
			NOT = { FROM = { army_tradition = 20 } }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.95
			NOT = { FROM = { army_tradition = 40 } }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.05
			FROM = { army_tradition = 60 }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.1
			FROM = { army_tradition = 80 }			
		}
		
		#Partly for gameplay, but Europe became insanely fortified during this period
		modifier = {
			factor = 1.25
			FROM = { technology_group = western }			
		}
		
		#Note Eastern, Ottoman, Muslim, East African, Indian, and Chinese tech groups receive no penalty nor bonus
		
		#Partly for gameplay, but these techs didn't really have the castle-every-100-meters thing going on for the most part
		modifier = {
			factor = 0.67
			FROM = {			
				OR = {
					technology_group = central_african
					technology_group = nomad_group
					technology_group = sub_saharan
					technology_group = north_american
					technology_group = mesoamerican
					technology_group = south_american
					technology_group = andean
				}
			}
		}
		modifier = {
			factor = 1000.0
			has_building = fort_15th
		}
		modifier = {
			factor = 1000.0
			is_capital = yes
		}
	}
}

#Tier 3 Fortification - Star Fort
fort_17th = {
	cost = 600
	time = 30

	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			OR = {
				is_capital_of = FROM
				all_neighbor_province = {
					NOT = {
						OR = {
							xorme_ai_is_building_fort_trigger = yes
							xorme_ai_has_any_fort_trigger = yes
							has_influencing_fort = yes
						}
					}
				}	
			}
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	
	#Time changed from 48 to 72 so fort levels are 1y, 2y, 3y and 4y respectively.
	
#	# THIS = Province, FROM = Builder(not nessecairly owner, can be overlord)
#	on_built = {
#		FROM = {
#			add_army_professionalism = 0.02
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings made obsolete!
#	on_destroyed = {
#		FROM = {
#			add_army_professionalism = -0.04
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings destroyed!
#	on_obsolete = {
#		hidden_effect = {
#			FROM = {
#				add_army_professionalism = -0.02
#			}
#		}
#	}
	
	make_obsolete = fort_16th
	modifier = {
		#VU changed from 6
		fort_level = 3
		
		#VU new
		local_unrest = -1.5
		
		#VU new
		local_defensiveness = 0.75
	}

	on_built = {
		if = {
			limit = {
				FROM = { NOT = { mil_tech = 19 } has_government_attribute = on_fort_built_nobles_loyalty }
			}
			FROM = {
				if = {
					limit = {
						has_estate = estate_nobles
					}
					add_estate_loyalty = {
						estate = estate_nobles
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_maratha
					}
					add_estate_loyalty = {
						estate = estate_maratha
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_rajput
					}
					add_estate_loyalty = {
						estate = estate_rajput
						loyalty = 5
					}
				}
			}
		}
		if = {
			limit = {
				owner = {
					has_estate_privilege = estate_nobles_development_of_castles
				}
				NOT = { has_province_modifier = estate_nobles_development_of_castles_mod }
			}
			add_province_modifier = {
				name = estate_nobles_development_of_castles_mod
				duration = -1
			}
		}
	}

	on_destroyed = {
		if = {
			limit = {
				FROM = {
					ai = yes
				}
			}
			FROM = { add_treasury = 300 }
		}
	}

	# THIS = Province, FROM = Destroyer, Will not be called on buildings destroyed!
	on_obsolete = {
	}

	onmap = yes
	influencing_fort = yes

	ai_will_do = {
		factor = 1.6
		
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 1200 } }
        }
		
		#SPECIFIC
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 2400 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 3600 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 4800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 6000 }
		}
		
		#GENERAL
		#AI would want to fortify their home province.
		modifier = {
			factor = 2
			is_capital = yes			
		}
		
		#Being a march encourages building forts
		modifier = {
			factor = 1.5
			FROM = { is_march = yes }
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.8
			NOT = { FROM = { army_tradition = 20 } }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.95
			NOT = { FROM = { army_tradition = 40 } }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.05
			FROM = { army_tradition = 60 }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.1
			FROM = { army_tradition = 80 }			
		}
		#Partly for gameplay, but Europe became insanely fortified during this period
		modifier = {
			factor = 1.25
			FROM = { technology_group = western }			
		}
		
		#Note Eastern, Ottoman, Muslim, East African, Indian, and Chinese tech groups receive no penalty nor bonus
		
		#Partly for gameplay, but these techs didn't really have the castle-every-100-meters thing going on for the most part
		modifier = {
			factor = 0.5
			FROM = {			
				OR = {
					technology_group = central_african
					technology_group = nomad_group
					technology_group = sub_saharan
					technology_group = north_american
					technology_group = mesoamerican
					technology_group = south_american
					technology_group = andean
				}
			}
		}
		modifier = {
			factor = 1000.0
			OR = {
				has_building = fort_15th
				has_building = fort_16th
			}
		}
		modifier = {
			factor = 1000.0
			is_capital = yes
		}
	}
}

#Tier 4 Fortification - Fortress
fort_18th = {
	cost = 800
	time = 30

	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			OR = {
				is_capital_of = FROM
				all_neighbor_province = {
					NOT = {
						OR = {
							xorme_ai_is_building_fort_trigger = yes
							xorme_ai_has_any_fort_trigger = yes
							has_influencing_fort = yes
						}
					}
				}	
			}
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	
	#VU cost changed from original 800
	#Time changed from 72 to 96 so fort levels are 1y, 2y, 3y and 4y respectively.
	
#	# THIS = Province, FROM = Builder(not nessecairly owner, can be overlord)
#	on_built = {
#		FROM = {
#			add_army_professionalism = 0.04
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings made obsolete!
#	on_destroyed = {
#		FROM = {
#			add_army_professionalism = -0.08
#		}
#	}
#
#	# THIS = Province, FROM = Destroyer, Will not be called on buildings destroyed!
#	on_obsolete = {
#		hidden_effect = {
#			FROM = {
#				add_army_professionalism = -0.04
#			}
#		}
#	}
	
	make_obsolete = fort_17th
	modifier = {
		#VU
		fort_level = 5
		
		#VU new
		local_unrest = -2.0
		
		#VU new
		local_defensiveness = 1.0
	}

	on_built = {
		if = {
			limit = {
				FROM = { has_government_attribute = on_fort_built_nobles_loyalty }
			}
			FROM = {
				if = {
					limit = {
						has_estate = estate_nobles
					}
					add_estate_loyalty = {
						estate = estate_nobles
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_maratha
					}
					add_estate_loyalty = {
						estate = estate_maratha
						loyalty = 5
					}
				}
				if = {
					limit = {
						has_estate = estate_rajput
					}
					add_estate_loyalty = {
						estate = estate_rajput
						loyalty = 5
					}
				}
			}
		}
		if = {
			limit = {
				owner = {
					has_estate_privilege = estate_nobles_development_of_castles
				}
				NOT = { has_province_modifier = estate_nobles_development_of_castles_mod }
			}
			add_province_modifier = {
				name = estate_nobles_development_of_castles_mod
				duration = -1
			}
		}
	}

	# THIS = Province, FROM = Destroyer, Will not be called on buildings made obsolete!
	on_destroyed = {
		if = {
			limit = {
				has_province_modifier = estate_nobles_development_of_castles_mod
			}
			remove_province_modifier = estate_nobles_development_of_castles_mod
		}
	}

	# THIS = Province, FROM = Destroyer, Will not be called on buildings destroyed!
	on_obsolete = {
	}

	onmap = yes
	influencing_fort = yes

	ai_will_do = {
		factor = 1.8
		
		#ECONOMY 101
        #AI avoids building with loans
        modifier = {
            factor = 0
            owner = { num_of_loans = 3 }
        }
        modifier = {
            factor = 0.3
            owner = { num_of_loans = 2 }
        }
        modifier = {
            factor = 0.5
            owner = { num_of_loans = 1 }
        }
        
        #AI avoids building when in deficit
        modifier = {
            factor = 0.75
            owner = { is_in_deficit = yes }
        }
        
        #AI will try to stockpile some amount of money
        modifier = {
            factor = 0.75
            owner = { NOT = { treasury = 1600 } }
        }
		
		#SPECIFIC
		#AI more likely to build when rich
		modifier = {
			factor = 1.5
			owner = { treasury = 3200 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 4800 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 6400 }
		}
		modifier = {
			factor = 1.5
			owner = { treasury = 8000 }
		}
		
		#GENERAL
		#AI would want to fortify their home province.
		modifier = {
			factor = 2
			is_capital = yes			
		}
				
		#Being a march encourages building forts
		modifier = {
			factor = 1.5
			FROM = { is_march = yes }
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.8
			NOT = { FROM = { army_tradition = 20 } }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 0.95
			NOT = { FROM = { army_tradition = 40 } }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.05
			FROM = { army_tradition = 60 }			
		}
		
		#Army tradition now either encourages or discourages building forts
		modifier = {
			factor = 1.1
			FROM = { army_tradition = 80 }			
		}
		
		#Partly for gameplay, but Europe became insanely fortified during this period
		modifier = {
			factor = 1.25
			FROM = { technology_group = western }			
		}
		
		#Note Eastern, Ottoman, Muslim, East African, Indian, and Chinese tech groups receive no penalty nor bonus
		
		#Partly for gameplay, but these techs didn't really have the castle-every-100-meters thing going on for the most part
		modifier = {
			factor = 0.33
			FROM = {			
				OR = {
					technology_group = central_african
					technology_group = nomad_group
					technology_group = sub_saharan
					technology_group = north_american
					technology_group = mesoamerican
					technology_group = south_american
					technology_group = andean
				}
			}
		}
		modifier = {
			factor = 1000.0
			OR = {
				has_building = fort_15th
				has_building = fort_16th
				has_building = fort_17th
			}
		}
		modifier = {
			factor = 1000.0
			is_capital = yes
		}
	}
}

################################################

### FORTIFICATION

#Tier 1 Fortification - Trench
trench = {
	cost = 50
	time = 2
	
	#Not possible to build a trench if the province already has a fort.
	
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			all_neighbor_province = {
				NOT = {
					OR = {
						xorme_ai_is_building_fort_trigger = yes
						xorme_ai_has_any_fort_trigger = yes
						has_influencing_fort = yes
					}
				}
			}
		}
	}
	
	#build_trigger = {
	#	NOT = {
	#		has_building = fort_15th
	#		has_building = fort_16th
	#		has_building = fort_17th
	#		has_building = fort_18th
	#	}
	#}
	
	modifier = {
		#Trench is equal in defense to a Bastion (Tier 2 Fort) with the exception of not reducing unrest.
		fort_level = 2
		local_defensiveness = 0.5
		
		#Trenches weren't like buildings that took space near city centers, so costing building slots doesn't really suit them.
		allowed_num_of_buildings = 1
		
		#While many died in trenches due to warfare, deaths caused by their terrible conditions (disease) were just as common.
		attrition = 10
		max_attrition = 10
		
		#To avoid making a trench be just like a fort but cheaper and faster, they're devastating to the development of provinces.
		local_monthly_devastation = 0.5
		local_development_cost = 0.5
	}

	onmap = yes
	influencing_fort = yes

	ai_will_do = {
		factor = 1
		
		modifier = {
			factor = 0
			NOT = {
				any_neighbor_province = {
					NOT = {
						controller = { tag = ROOT }
					}
				}	
			}
		}
		
		#AI will only be build during a war
		modifier = {
			factor = 0
			owner = { is_at_war = no }
		}
		
		#AI will build in provinces that border enemy or occupied provinces
		modifier = {
			factor = 2
			any_neighbor_province = {
				controller = {
					war_with = ROOT
				}
			}
		}
	}
}

################################################

### MANUFACTORY

manufactory = {
	cost = 500
	time = 60			#VU changed from 60. 5 year construction times are way out of line with all other buildings, and quite unneccessary, I think. Reducing this to comparable with other buildings.
	modifier = {
		trade_goods_size = 1.0
	}
}

#If trade good assignment changes, also update scripted trigger "has_manufactory trigger"!

wharf = {
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	manufactory = {
		fish
		naval_supplies
		salt
		seafood
		tar
		tropical_wood
	}
	modifier = {
		trade_goods_size = 0.4			#VU Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VU changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		naval_forcelimit = 1			#VU new - Just a fun little new bonus
	}

	keep_trigger = {
		OR = {
			trade_goods = fish
			trade_goods = naval_supplies
			trade_goods = salt
			trade_goods = seafood
			trade_goods = tar
			trade_goods = tropical_wood
		}
	}
	onmap = yes
	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1 
		}
		
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		remove_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 1000			#VU Addon changed from 1. Changing all base factors to price divided by 100. AI apparently doesn't factor the modifier, just the raw size increase, so also increasing weight beyond that by 20 percent for manufacturies with other bonuses, and 60 for non-factored bonuses. Note vanilla was 1750, but considering this building had the same effect as other manufacturies and they all have factors of 1, I assumed this was a vanilla oversight.
		#VU Addon removed a bunch of modifiers for the same reason as directly above.
		#VU Addon New factors, range 2 percent to about 425 percent
		modifier = {
			factor = 0.9
			FROM = { technology_group = eastern }
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 5
			OR = {
				has_province_modifier = skanemarket
				has_province_modifier = comet_ore_modifier
				has_province_modifier = paradise_modifier
			}
		}
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { technology_group = western }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			owner = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.5
			owner = { navy_size_percentage = 0.9 }
		}
		modifier = {
			factor = 1.5
			FROM = { navy_tradition = 50 }
		}
		modifier = {
			factor = 1.1
			base_production = 4
		}
		modifier = {
			factor = 1.2
			base_production = 8
		}
		modifier = {
			factor = 1.4
			base_production = 12
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 0.4
			NOT = { base_production = 3 }
		}
		modifier = {
			factor = 0.8
			NOT = { base_production = 4 }
		}
		modifier = {
			factor = 3.0
			base_production = 4
		}
		modifier = {
			factor = 6.0
			base_production = 6
		}
		modifier = {
			factor = 9.0
			base_production = 8
		}
		modifier = {
			factor = 10.0
			base_production = 15
		}
		modifier = {
			factor = 2.5
			has_building = workshop
		}
		modifier = {
			factor = 3.5
			has_building = counting_house
		}
		#Xorme
		modifier = {
			factor = 10.0
			xorme_province_with_special_goods_produced_trigger = yes
		}
	}
}

weapons = {
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	manufactory = {
		cannon
		copper
		iron
		lead
		mercury
		metalworking
		munitions
		tin
		zinc
	}
	modifier = {
		trade_goods_size = 0.4			#VUAddon Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VUAddOn changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		land_forcelimit = 0.5			#VUAddOn new - Just a fun little new bonus
	}
	onmap = yes

	keep_trigger = {
		OR = {
			trade_goods = cannon
			trade_goods = copper
			trade_goods = iron
			trade_goods = lead
			trade_goods = mercury
			trade_goods = metalworking
			trade_goods = munitions
			trade_goods = tin
			trade_goods = zinc
		}
	}

	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = manpower 
			value = 1 
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		remove_dev_from_building = {
			building = manufactory 
			type = manpower 
			value = 1
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 1000			#VU Addon changed from 1. Changing all base factors to price divided by 100. AI apparently doesn't factor the modifier, just the raw size increase, so also increasing weight beyond that by 20 percent for manufacturies with other bonuses, and 60 for non-factored bonuses.
		#VU Addon New factors, range 2 percent to about 425 percent
		modifier = {
			factor = 0.9
			FROM = { technology_group = eastern }
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { technology_group = western }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			owner = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.5
			owner = { army_size_percentage = 0.9 }
		}
		modifier = {
			factor = 1.5
			FROM = { army_tradition = 50 }
		}
		modifier = {
			factor = 1.1
			base_production = 4
		}
		modifier = {
			factor = 1.2
			base_production = 8
		}
		modifier = {
			factor = 1.4
			base_production = 12
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 0.4
			NOT = { base_production = 3 }
		}
		modifier = {
			factor = 0.8
			NOT = { base_production = 4 }
		}
		modifier = {
			factor = 3.0
			base_production = 4
		}
		modifier = {
			factor = 6.0
			base_production = 6
		}
		modifier = {
			factor = 9.0
			base_production = 8
		}
		modifier = {
			factor = 10.0
			base_production = 15
		}
		modifier = {
			factor = 2.5
			has_building = workshop
		}
		modifier = {
			factor = 3.5
			has_building = counting_house
		}
		#Xorme
		modifier = {
			factor = 10.0
			xorme_province_with_special_goods_produced_trigger = yes
		}
	}
}

textile = {
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	manufactory = {
		books
		cloth
		dyes
		indigo
		silk
		uniforms 
		lace
	}
	modifier = {
		trade_goods_size = 0.4			#VU Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VU changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		local_tax_modifier = 0.25			#VU new - Just a fun little new bonus
	}
	onmap = yes

	keep_trigger = {
		OR = {
			trade_goods = books
			trade_goods = cloth
			trade_goods = dyes
			trade_goods = indigo
			trade_goods = silk
			trade_goods = uniforms 
			trade_goods = wool
		}
	}

	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1 
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		remove_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 1000			#VU Addon changed from 1. Changing all base factors to price divided by 100. AI apparently doesn't factor the modifier, just the raw size increase, so also increasing weight beyond that by 20 percent for manufacturies with other bonuses, and 60 for non-factored bonuses.
		#VU Addon New factors, range 2 percent to about 425 percent
		modifier = {
			factor = 0.9
			FROM = { technology_group = eastern }
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { technology_group = western }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			owner = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.1
			base_tax = 4
		}
		modifier = {
			factor = 1.2
			base_tax = 8
		}
		modifier = {
			factor = 1.4
			base_tax = 12
		}
		modifier = {
			factor = 1.1
			base_production = 4
		}
		modifier = {
			factor = 1.2
			base_production = 8
		}
		modifier = {
			factor = 1.4
			base_production = 12
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 0.4
			NOT = { base_production = 3 }
		}
		modifier = {
			factor = 0.8
			NOT = { base_production = 4 }
		}
		modifier = {
			factor = 3.0
			base_production = 4
		}
		modifier = {
			factor = 6.0
			base_production = 6
		}
		modifier = {
			factor = 9.0
			base_production = 8
		}
		modifier = {
			factor = 10.0
			base_production = 15
		}
		modifier = {
			factor = 2.5
			has_building = workshop
		}
		modifier = {
			factor = 3.5
			has_building = counting_house
		}
		#Xorme
		modifier = {
			factor = 10.0
			xorme_province_with_special_goods_produced_trigger = yes
		}
	}
}

plantations = {
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	manufactory = {
		chocolate
		cinnamon
		cloves
		cocoa
		coffee
		cotton
		dates
		nutmeg
		opium
		palm_oil
		saffron
		sugar
		tea
		tobacco
		vanilla
	}
	modifier = {
			#Changed for VU: With different effects of slaves/indentured servants the plantation gets better and better
			#As I don't know how it interacts if the same modifier is 2 times active, I have added them together within the if-clause -Lord_Bowser
		trade_goods_size = 0.4			#VU Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VU changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		local_production_efficiency = 0.25			#VU new - Just a fun little new bonus#
		# if = {
			# limit = {
				# has_country_flag = vu_slaves_size_1
			# }
			# trade_goods_size = 0.75
			# trade_goods_size_modifier = 0.7
		# }
		# else_if = {
			# limit = {
				# has_country_flag = vu_slaves_size_2
			# }
			# trade_goods_size = 1
			# trade_goods_size_modifier = 0.8
		# }
		# else_if = {
			# limit = {
				# has_country_flag = vu_slaves_size_3
			# }
			# trade_goods_size = 1.5
			# trade_goods_size_modifier = 1
		# }
		# else_if = {
			# limit = {
				# has_country_flag = vu_indentured_servants
			# }
			# trade_goods_size = 0.6
			# trade_goods_size_modifier = 0.6
		# }
		# else = {
			# trade_goods_size = 0.4
			# trade_goods_size_modifier = 0.5
		# }
	}
	onmap = yes
	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1 
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		remove_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1
		}
	}
	on_obsolete = {
	}

	keep_trigger = {
		OR = {
			trade_goods = chocolate
			trade_goods = cinnamon
			trade_goods = cloves
			trade_goods = cocoa
			trade_goods = coffee
			trade_goods = cotton
			trade_goods = dates
			trade_goods = nutmeg
			trade_goods = opium
			trade_goods = palm_oil
			trade_goods = saffron
			trade_goods = sugar
			trade_goods = tea
			trade_goods = tobacco
			trade_goods = vanilla
		}
	}

	ai_will_do = {
		factor = 1000			#VU Addon changed from 1. Changing all base factors to price divided by 100. AI apparently doesn't factor the modifier, just the raw size increase, so also increasing weight beyond that by 20 percent for manufacturies with other bonuses, and 60 for non-factored bonuses.
		#VU Addon New factors, range 2 percent to about 425 percent
		modifier = {
			factor = 0.9
			FROM = { technology_group = eastern }
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { technology_group = western }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			owner = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.15
			base_production = 4
		}
		modifier = {
			factor = 1.3
			base_production = 8
		}
		modifier = {
			factor = 1.6
			base_production = 12
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 0.4
			NOT = { base_production = 3 }
		}
		modifier = {
			factor = 0.8
			NOT = { base_production = 4 }
		}
		modifier = {
			factor = 3.0
			base_production = 4
		}
		modifier = {
			factor = 6.0
			base_production = 6
		}
		modifier = {
			factor = 9.0
			base_production = 8
		}
		modifier = {
			factor = 10.0
			base_production = 15
		}
		modifier = {
			factor = 2.5
			has_building = workshop
		}
		modifier = {
			factor = 3.5
			has_building = counting_house
		}
		#Xorme
		modifier = {
			factor = 10.0
			xorme_province_with_special_goods_produced_trigger = yes
		}
	}
}

tradecompany = {
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	manufactory = {
		beer
		cider
		carpet
		cheese
		cigars
		cloves
		exotic_animals
		fur
		gunpowder
		incense
		ivory
		jade
		jewellery
		leather
		maple_syrup
		marble
		marble_sculpture
		rum
		sea_turtle
		slaves
		spices
		sulfur
		whaling
		woodworking
	}
	modifier = {
		trade_goods_size = 0.4			#VU Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VU changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		province_trade_power_modifier = 0.5			#VU new - Just a fun little new bonus

			#Changed for VU: With different effects of slaves/indentured servants more spices and cloves get produced
			#As I don't know how it interacts if the same modifier is 2 times active, I have added them together within the if-clause -Lord_Bowser
		# if = {
			# limit = {
				# OR = {
					# trade_goods = spices
					# trade_goods = cloves
				# }
			# }
			# if = {
				# limit = {
					# has_country_flag = vu_slaves_size_1
				# }
				# trade_goods_size = 0.75
				# trade_goods_size_modifier = 0.7
			# }
			# else_if = {
				# limit = {
					# has_country_flag = vu_slaves_size_2
				# }
				# trade_goods_size = 1
				# trade_goods_size_modifier = 0.8
			# }
			# else_if = {
				# limit = {
					# has_country_flag = vu_slaves_size_3
				# }
				# trade_goods_size = 1.5
				# trade_goods_size_modifier = 1
			# }
			# else_if = {
				# limit = {
					# has_country_flag = vu_indentured_servants
				# }
				# trade_goods_size = 0.6
				# trade_goods_size_modifier = 0.6
			# }
		# }
	}
	onmap = yes
	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1 
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		remove_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1
		}
	}
	on_obsolete = {
	}

	keep_trigger = {
		OR = {
			trade_goods = beer
			trade_goods = cider
			trade_goods = carpet
			trade_goods = cheese
			trade_goods = cigars
			trade_goods = cloves
			trade_goods = exotic_animals
			trade_goods = fur
			trade_goods = gunpowder
			trade_goods = incense
			trade_goods = ivory
			trade_goods = jade
			trade_goods = jewellery
			trade_goods = leather
			trade_goods = maple_syrup
			trade_goods = marble
			trade_goods = marble_sculpture
			trade_goods = rum
			trade_goods = sea_turtle
			trade_goods = slaves
			trade_goods = spices
			trade_goods = sulfur
			trade_goods = whaling
			trade_goods = woodworking
		}
	}

	ai_will_do = {
		factor = 1000			#VU Addon changed from 1. Changing all base factors to price divided by 100. AI apparently doesn't factor the modifier, just the raw size increase, so also increasing weight beyond that by 20 percent for manufacturies with other bonuses, and 60 for non-factored bonuses.
		#VU Addon New factors, range 2 percent to about 425 percent
		modifier = {
			factor = 0.9
			FROM = { technology_group = eastern }
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { technology_group = western }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			owner = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.3
			owner = { full_idea_group = trade_ideas }
		}
		modifier = {
			factor = 1.1
			province_trade_power = 5			#Note trade power 5 is 21 dev non coastal with 0 autonomy, starting mercantalism, and no estate. OR 9 dev coastal with 40 mercantalism, 0 autonomy, burgher estate, max tech, and trade national ideas, OR some combination of the two.
		}
		modifier = {
			factor = 1.2
			province_trade_power = 8			#Note 8 trade power is between 31 dev and 14 dev (or 3 dev for CoTs), depending on modifiers, estates, mercantalism, autonomy etc.
		}
		modifier = {
			factor = 1.4
			province_trade_power = 12			#Note 12 trade power is between
		}
		modifier = {
			factor = 1.1
			base_production = 4
		}
		modifier = {
			factor = 1.2
			base_production = 8
		}
		modifier = {
			factor = 1.4
			base_production = 12
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 0.4
			NOT = { base_production = 3 }
		}
		modifier = {
			factor = 0.8
			NOT = { base_production = 4 }
		}
		modifier = {
			factor = 3.0
			base_production = 4
		}
		modifier = {
			factor = 6.0
			base_production = 6
		}
		modifier = {
			factor = 9.0
			base_production = 8
		}
		modifier = {
			factor = 10.0
			base_production = 15
		}
		modifier = {
			factor = 2.5
			has_building = workshop
		}
		modifier = {
			factor = 3.5
			has_building = counting_house
		}
		#Xorme
		modifier = {
			factor = 10.0
			xorme_province_with_special_goods_produced_trigger = yes
		}
	}
}

farm_estate = {
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	manufactory = {
		apiculture
		beer
		cider
		camel
		champagne
		citrus
		elephants
		fruit
		grain
		horses
		livestock
		llama
		maize
		olive_oil
		potato
		rice
		tomato
		vodka
		whiskey
	}
	modifier = {
		trade_goods_size = 0.4			#VU Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VU changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		local_production_efficiency = 0.25			#VU new - Just a fun little new bonus
		
		#Changed for VU: With different effects of serfs farm estates can produce more
		#As I don't know how it interacts if the same modifier is 2 times active, I have added them together within the if-clause -Lord_Bowser
		# if = {
			# limit = {
				# has_country_flag = vu_serfs_1
			# }
			# trade_goods_size = 0.75
			# trade_goods_size_modifier = 0.8
		
		# }
		# else_if = {
			# limit = {
				# has_country_flag = vu_serfs_2
			# }
			# trade_goods_size = 1
			# trade_goods_size_modifier = 1
		# }
		# else = {
			# trade_goods_size = 0.4
			# trade_goods_size_modifier = 0.5	
		# }
	}
	onmap = yes

	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1
		}
	}
	on_destroyed = {
		add_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1 
		}
		remove_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1
		}
	}
	on_obsolete = {
	}

	keep_trigger = {
		OR = {
			trade_goods = apiculture
			trade_goods = beer
			trade_goods = cider
			trade_goods = camel
			trade_goods = champagne
			trade_goods = citrus
			trade_goods = elephants
			trade_goods = fruit
			trade_goods = grain
			trade_goods = horses
			trade_goods = livestock
			trade_goods = llama
			trade_goods = maize
			trade_goods = olive_oil
			trade_goods = potato
			trade_goods = rice
			trade_goods = tomato
			trade_goods = vodka
			trade_goods = wine
		}
	}

	ai_will_do = {
		factor = 1000			#VU Addon changed from 1. Changing all base factors to price divided by 100. AI apparently doesn't factor the modifier, just the raw size increase, so also increasing weight beyond that by 20 percent for manufacturies with other bonuses, and 60 for non-factored bonuses.
		#VU Addon New factors, range 2 percent to about 425 percent
		modifier = {
			factor = 0.9
			FROM = { technology_group = eastern }
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { technology_group = western }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			owner = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.15
			base_production = 4
		}
		modifier = {
			factor = 1.3
			base_production = 8
		}
		modifier = {
			factor = 1.6
			base_production = 12
		}
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 0.4
			NOT = { base_production = 3 }
		}
		modifier = {
			factor = 0.8
			NOT = { base_production = 4 }
		}
		modifier = {
			factor = 3.0
			base_production = 4
		}
		modifier = {
			factor = 6.0
			base_production = 6
		}
		modifier = {
			factor = 9.0
			base_production = 8
		}
		modifier = {
			factor = 10.0
			base_production = 15
		}
		modifier = {
			factor = 2.5
			has_building = workshop
		}
		modifier = {
			factor = 3.5
			has_building = counting_house
		}
		#Xorme
		modifier = {
			factor = 10.0
			xorme_province_with_special_goods_produced_trigger = yes
		}
	}
}

mills = {
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	manufactory = {
		amber
		chinaware
		diamonds
		ebony
		gems
		glass
		lumber
		optics
		paper
		pearls
		steam_engine
		tropical_wood
		bamboo
		pottery
	}
	modifier = {
		trade_goods_size = 0.4			#VUAddon Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VUAddOn changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		local_tax_modifier = 0.25			#VUAddOn new - Just a fun little new bonus
	}
	onmap = yes

	keep_trigger = {
		OR = {
			trade_goods = amber
			trade_goods = chinaware
			trade_goods = diamonds
			trade_goods = ebony
			trade_goods = gems
			trade_goods = glass
			trade_goods = lumber
			trade_goods = optics
			trade_goods = paper
			trade_goods = pearls
			trade_goods = steam_engine
			trade_goods = tropical_wood
		}
	}

	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1 
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		remove_dev_from_building = {
			building = manufactory 
			type = production 
			value = 1
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 1000
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		modifier = {
			factor = 0.9
			FROM = { technology_group = eastern }
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { technology_group = western }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			owner = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.1
			base_tax = 4
		}
		modifier = {
			factor = 1.2
			base_tax = 8
		}
		modifier = {
			factor = 1.4
			base_tax = 12
		}
		modifier = {
			factor = 1.1
			base_production = 4
		}
		modifier = {
			factor = 1.2
			base_production = 8
		}
		modifier = {
			factor = 1.4
			base_production = 12
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 0.4
			NOT = { base_production = 3 }
		}
		modifier = {
			factor = 0.8
			NOT = { base_production = 4 }
		}
		modifier = {
			factor = 3.0
			base_production = 4
		}
		modifier = {
			factor = 6.0
			base_production = 6
		}
		modifier = {
			factor = 9.0
			base_production = 8
		}
		modifier = {
			factor = 10.0
			base_production = 15
		}
		modifier = {
			factor = 2.5
			has_building = workshop
		}
		modifier = {
			factor = 3.5
			has_building = counting_house
		}
		#Xorme
		modifier = {
			factor = 10.0
			xorme_province_with_special_goods_produced_trigger = yes
		}
	}
}

furnace = {
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	manufactory = {
		coal
	}

	potential = {
		has_dlc = "Rule Britannia"
	}

	modifier = {
		trade_goods_size = 0.4			#VUAddon Note - Alright, alright. I'm giving in. It makes no sense, but vanilla apparently didn't bother to code in compatibility with the modifier version, so I have little choice but to give a flat bonus here.
		trade_goods_size_modifier = 0.5			#VUAddOn changed from flat trade good size increase. Logic above at the top of Manufactories entries.
		global_trade_goods_size_modifier = 0.035		#VUAddOn changed from 0.05. This was just too huge, especially with all the new provinces.
	}
	onmap = yes
	show_separate = yes # Means as a manufactory it will be shown according to the old way

	keep_trigger = {
		trade_goods = coal
	}

	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 2000.0			#VU Addon changed from 1. Changing all base factors to price divided by 100. AI apparently doesn't factor the modifier, just the raw size increase, so also increasing weight beyond that by 20 percent for manufacturies with other bonuses, and 60 for non-factored bonuses.
		#VU Addon New factors, range 2 percent to about 425 percent
		modifier = {
			factor = 4.0
			development = 10
		}
		modifier = {
			factor = 0.9
			FROM = { technology_group = eastern }
		}	#Minor penalty for eastern tech
		modifier = {
			factor = 0.6
			FROM = {
				OR = {
					technology_group = ottoman
					technology_group = muslim
				}
			}
		}	#Lesser penalty for non european medium-high tech groups.
		modifier = {
			factor = 0.4
			FROM = {
				OR = {
					technology_group = indian
					technology_group = east_african
					technology_group = chinese
					technology_group = sub_saharan
					technology_group = central_african
					technology_group = nomad_group
				}
			}
		}	#Penalty for medium-low tech groups
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					technology_group = mesoamerican
					technology_group = andean
					technology_group = north_american
					technology_group = south_american
					#Any other future new world cultures should be added here
				}
			}
		}	#Much like the university, some technology groups simply did not have the infrastructure, history, or circumstance to evolve and develop in this way.
		modifier = {
			factor = 1.5
			FROM = { is_great_power = yes }
		}	#Great powers get a sustantial bonus, putting Muslims on par with Europeans, other Old World techs on par with Muslims, and rocketing European powers even higher.
		modifier = {
			factor = 0.1
			FROM = {
				AND = {
					NOT = { technology_group = western }
					NOT = { total_development = 100 }
				}
			}
		}	#Small non western AI countries shouldn't be grasping like this, institutions can spread to them from bigger neighbours. Further penalty even beyond the tech group penalty above.
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = entrepreneur_personality }
		}
		modifier = {
			factor = 1.3
			owner = { ruler_has_personality = industrious_personality }
		}
		modifier = {
			factor = 1.3
			owner = { full_idea_group = economic_ideas }
		}
		modifier = {
			factor = 1.15
			base_production = 4
		}
		modifier = {
			factor = 1.3
			base_production = 8
		}
		modifier = {
			factor = 1.6
			base_production = 12
		}
	}
}

ramparts = {
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	manufactory = {
		all
	}
	modifier = {
		local_hostile_attrition = 1
		local_defensiveness = 0.15
		local_defender_dice_roll_bonus = 1
	}
	onmap = no
	show_separate = yes # Means as a manufactory it will be shown according to the old way
	
	on_built = {
		add_dev_from_building = {
			building = manufactory 
			type = manpower 
			value = 1 
		}
		if = {
			limit = {
				owner = {
					has_estate_privilege = estate_nobles_development_of_castles
				}
				NOT = { has_province_modifier = estate_nobles_development_of_castles_ramparts_mod }
			}
			add_province_modifier = {
				name = estate_nobles_development_of_castles_ramparts_mod
				duration = -1
			}
		}
	}
	
	on_destroyed = {
		remove_dev_from_building = {
			building = manufactory 
			type = manpower 
			value = 1
		}
		if = {
			limit = {
				has_province_modifier = estate_nobles_development_of_castles_ramparts_mod
			}
			remove_province_modifier = estate_nobles_development_of_castles_ramparts_mod
		}
	}
	ai_will_do = {
		factor = 0
	}
}

soldier_households = {
	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}
	manufactory = {
		all
	}

	bonus_manufactory = { # Will apply an extra modifier if these goods
		apiculture
		beer
		cider
		camel
		champagne
		citrus
		elephants
		fish
		grain
		horses
		livestock
		llama
		maize
		olive_oil
		potato
		rice
		wine
	}

	modifier = {
		local_manpower = 0.75
	}
	bonus_modifier = {
		local_manpower = 0.75
	}
	onmap = no
	show_separate = yes # Means as a manufactory it will be shown according to the old way
	on_built = {
		add_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		add_dev_from_building = {
			building = manufactory 
			type = manpower 
			value = 1 
		}
		if = {
			limit = {
				FROM = {
					has_government_attribute = improved_military_buildings
				}
			}
			add_province_modifier = {
				name = wei_suo_system_reform_soldier_households_modifier
				duration = -1
			}
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = manufactory
			type = production
			value = 2
		}
		remove_dev_from_building = {
			building = manufactory 
			type = manpower 
			value = 1
		}
		if = {
			limit = {
				has_province_modifier = wei_suo_system_reform_soldier_households_modifier
			}
			remove_province_modifier = wei_suo_system_reform_soldier_households_modifier
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 10.0
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 0.1
			xorme_high_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 0.2
			xorme_medium_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 0.5
			base_production = 5
		}
		modifier = {
			factor = 2.5
			base_manpower = 4
		}
		modifier = {
			factor = 5.0
			base_manpower = 8
		}
		modifier = {
			factor = 7.5
			base_manpower = 12
		}
		modifier = {
			factor = 10.0
			OR = {
				has_building = barracks
				has_building = training_fields
			}
		}
		modifier = {
			factor = 1000
			xorme_additional_manpower_goods_trigger = yes
		}
	}
}

impressment_offices = {
	manufactory = {
		all
	}

	bonus_manufactory = { # Will apply an extra modifier if these goods
		beer
		cider
		fish
		lumber
		naval_supplies
		salt
		seafood
		tar
		tropical_wood
	}

	build_trigger = {
		has_port = yes
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
	}

	modifier = {
		local_sailors = 250
		ship_recruit_speed = -0.1
		local_ship_cost = -0.05
	}
	bonus_modifier = {
		local_sailors = 250
		ship_recruit_speed = -0.1
		local_ship_cost = -0.05
	}
	onmap = no
	show_separate = yes # Means as a manufactory it will be shown according to the old way
	on_built = {
		add_development_from_building = {
			building = impressment_offices
			type = manpower
			value = 2
		}
		add_dev_from_building = {
			building = impressment_offices 
			type = manpower 
			value = 1 
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = impressment_offices
			type = manpower
			value = 2
		}
		remove_dev_from_building = {
			building = impressment_offices 
			type = manpower 
			value = 1 
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 5
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 0.1
			xorme_high_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 0.2
			xorme_medium_quality_trade_goods_trigger = yes
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
	}
}


state_house = {
	manufactory = {
		all
	}

	bonus_manufactory = { # Will apply an extra modifier if these goods
		amber
		chinaware
		diamonds
		ebony
		gems
		glass
		jade
		jewellery
		lumber
		marble
		optics
		paper
		steam_engine
		tropical_wood
	}

	build_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
		NOT = {
			area_for_scope_province = {
				FROM = {
					tag = ROOT
				}
				OR = {
					has_building = state_house
					has_construction = state_house
				}
			}
		}
	}

	keep_trigger = {
		if = {
			limit = { FROM = { ai = yes } }
			FROM = { NOT = { num_of_loans = 4 } }
		}
		NOT = {
			area_for_scope_province = {
				NOT = { province_id = root }
				FROM = {
					tag = ROOT
				}
				OR = {
					has_building = state_house
					has_construction = state_house
				}
			}
		}
	}
	modifier = {
		statewide_governing_cost = -0.2
		min_local_autonomy = -5
		local_governing_cost = -0.15
		local_governing_cost_increase = -10
		allowed_num_of_buildings = 1
	}
	bonus_modifier = {
		statewide_governing_cost = -0.2
		min_local_autonomy = -5
		local_governing_cost = -0.15
		local_governing_cost_increase = -10
	}
	onmap = no
	show_separate = yes # Means as a manufactory it will be shown according to the old way
	on_built = {
		add_development_from_building = {
			building = state_house
			type = tax
			value = 2
		}
	}
	on_destroyed = {
		remove_development_from_building = {
			building = state_house
			type = tax
			value = 2
		}
	}
	on_obsolete = {
	}

	ai_will_do = {
		factor = 35.0
		modifier = {
			factor = 0
			FROM = { num_of_loans = 1 }
		}
		modifier = {
			factor = 4.5
			owner = { is_subject = yes }
		}
		modifier = {
			factor = 100.0
			FROM = { treasury = 10000 }
		}
		modifier = {
			factor = 0
			xorme_province_with_special_goods_produced_trigger = yes
			NOT = { trade_goods = gold }
		}
		modifier = {
			factor = 25.0
			is_state = yes
		}
		modifier = {
			factor = 25.0
			FROM = { governing_capacity_percentage = 0.9 }
		}
		modifier = {
			factor = 25.0
			NOT = {
				AND = {
					base_manpower = 4
					base_production = 4
					base_tax = 4
				}
			}
		}
		modifier = {
			factor = 2000
			trade_goods = gold
		}
	}
}

oil_well = {

	manufactory = {
		oil
	}

	potential = {
		has_dlc = "Rule Britannia"
	}

	modifier = {
		global_trade_goods_size_modifier = 0.05 #National Bonus
	}
	onmap = yes
	show_separate = yes # Means as a manufactory it will be shown according to the old way
	
	ai_will_do = {
		factor = 1
	}
}